import{r as ar,w as rt,d as nr}from"../chunks/index.f4516e11.js";import{g as sr,f as Jt}from"../chunks/BaseRepo.b0f9c191.js";import{A as at,T as We,b as ir,c as or,d as lr,p as cr}from"../chunks/store.e78cf838.js";import{T as Gt,A as ur,C as dr}from"../chunks/index.a741e51b.js";import{S as Je,i as Ge,s as Xe,w as ut,R as dt,k as g,a as W,y as Ne,l as v,m as b,h as d,c as Q,z as Fe,n as p,b as me,A as Ve,g as _e,v as nt,d as we,f as st,T as ft,B as Pe,D as ze,q as ve,r as be,E as i,F as De,u as Ye,K as it,G as ot,p as et,I as He,V as fr,W as Ot,C as St,X as hr,e as $t,H as Mt,U as pr,N as mr}from"../chunks/index.7e2123bf.js";import{j as _r}from"../chunks/singletons.2de09f3e.js";import{C as gr}from"../chunks/CreateUpdateModal.31e618e7.js";import{a as Xt}from"../chunks/Confirm.f680d602.js";import{M as Yt}from"../chunks/Money.83140549.js";import{a as vr}from"../chunks/ContextMenu.11bf820a.js";import{C as Zt}from"../chunks/CategoryIcon.fc906b4d.js";import{b as Nt}from"../chunks/Alert.15f62c24.js";import{S as br}from"../chunks/save.b13e5ae7.js";function xt(a,e,n){return ar(n==null?void 0:n.initialValue,c=>{let l=null;const f=D=>{l&&l.unsubscribe(),l=sr(()=>a(D)).subscribe({next:y=>{c(y)},error:n==null?void 0:n.onError})};e&&e.subscribe(D=>{f(D)})})}function er(a,e){const n=[],s=[];for(let c=0;c<a.length;c++)a[c].subscribe(l=>{n[c]=l,n.length==a.length&&e(n)});return()=>{s.forEach(c=>c())}}const Qe=rt({accountId:null,date:Jt()}),tt=rt(!1),Er=xt(a=>at.getById(a.accountId),Qe,{initialValue:[]}),tr=xt(a=>(je.set(new Map),We.getByAccount(a.accountId,a.date)),Qe,{initialValue:[]}),je=rt(new Map),ht=rt([]),kr=nr(ht,a=>Gt.getTransactionsRecap(a));er([tt,je],([a,e])=>{a&&ht.set(Array.from(e,([n,s])=>s))});er([tt,tr],([a,e])=>{a||ht.set(e)});function yr({params:a}){Qe.update(e=>(e.accountId=a.id,e))}const la=Object.freeze(Object.defineProperty({__proto__:null,load:yr},Symbol.toStringTag,{value:"Module"})),wr=_r("goto");function Ft(a,e,n){const s=a.slice();return s[7]=e[n],s}function Vt(a){let e,n,s,c,l,f,D,o,y,u,I,m,T,H,j,C,P,S,L,U,oe=a[0].name+"",ae,V,t,r,h,w,A,F;n=new Yt({props:{value:a[0].balance}});let _=a[1].categoriesNegative,$=[];for(let k=0;k<_.length;k+=1)$[k]=Pt(Ft(a,_,k));return h=new ur({props:{transactionsTotals:a[1].totals}}),{c(){e=g("h2"),Ne(n.$$.fragment),s=W(),c=g("div"),l=g("div"),f=g("button"),D=g("span"),o=g("i"),y=W(),u=g("div"),I=g("div"),m=g("a"),T=g("i"),H=ve(" Edit account"),j=W(),C=g("a"),P=g("i"),S=ve(" Delete account"),L=W(),U=g("span"),ae=ve(oe),V=W(),t=g("div");for(let k=0;k<$.length;k+=1)$[k].c();r=W(),Ne(h.$$.fragment),this.h()},l(k){e=v(k,"H2",{class:!0});var E=b(e);Fe(n.$$.fragment,E),s=Q(E),c=v(E,"DIV",{class:!0});var z=b(c);l=v(z,"DIV",{class:!0});var M=b(l);f=v(M,"BUTTON",{class:!0,"aria-haspopup":!0});var q=b(f);D=v(q,"SPAN",{class:!0});var ee=b(D);o=v(ee,"I",{class:!0}),b(o).forEach(d),ee.forEach(d),q.forEach(d),M.forEach(d),y=Q(z),u=v(z,"DIV",{class:!0,role:!0});var O=b(u);I=v(O,"DIV",{class:!0});var Y=b(I);m=v(Y,"A",{class:!0});var J=b(m);T=v(J,"I",{class:!0}),b(T).forEach(d),H=be(J," Edit account"),J.forEach(d),j=Q(Y),C=v(Y,"A",{class:!0});var te=b(C);P=v(te,"I",{class:!0}),b(P).forEach(d),S=be(te," Delete account"),te.forEach(d),Y.forEach(d),O.forEach(d),z.forEach(d),E.forEach(d),L=Q(k),U=v(k,"SPAN",{class:!0});var le=b(U);ae=be(le,oe),le.forEach(d),V=Q(k),t=v(k,"DIV",{class:!0});var ue=b(t);for(let re=0;re<$.length;re+=1)$[re].l(ue);ue.forEach(d),r=Q(k),Fe(h.$$.fragment,k),this.h()},h(){p(o,"class","fa-solid fa-ellipsis-vertical"),p(D,"class","icon is-small"),p(f,"class","button is-small is-light"),p(f,"aria-haspopup","true"),p(l,"class","dropdown-trigger"),p(T,"class","fa-solid fa-file-pen mr-1"),p(m,"class","dropdown-item"),p(P,"class","fa-solid fa-trash mr-1"),p(C,"class","dropdown-item has-text-danger"),p(I,"class","dropdown-content"),p(u,"class","dropdown-menu"),p(u,"role","menu"),p(c,"class","dropdown is-right"),p(e,"class","title flex-container"),p(U,"class","has-text-grey"),p(t,"class","progress")},m(k,E){me(k,e,E),Ve(n,e,null),i(e,s),i(e,c),i(c,l),i(l,f),i(f,D),i(D,o),i(c,y),i(c,u),i(u,I),i(I,m),i(m,T),i(m,H),i(I,j),i(I,C),i(C,P),i(C,S),me(k,L,E),me(k,U,E),i(U,ae),me(k,V,E),me(k,t,E);for(let z=0;z<$.length;z+=1)$[z]&&$[z].m(t,null);me(k,r,E),Ve(h,k,E),w=!0,A||(F=[De(m,"click",a[5]),De(C,"click",a[4])],A=!0)},p(k,E){const z={};if(E&1&&(z.value=k[0].balance),n.$set(z),(!w||E&1)&&oe!==(oe=k[0].name+"")&&Ye(ae,oe),E&10){_=k[1].categoriesNegative;let q;for(q=0;q<_.length;q+=1){const ee=Ft(k,_,q);$[q]?$[q].p(ee,E):($[q]=Pt(ee),$[q].c(),$[q].m(t,null))}for(;q<$.length;q+=1)$[q].d(1);$.length=_.length}const M={};E&2&&(M.transactionsTotals=k[1].totals),h.$set(M)},i(k){w||(_e(n.$$.fragment,k),_e(h.$$.fragment,k),w=!0)},o(k){we(n.$$.fragment,k),we(h.$$.fragment,k),w=!1},d(k){k&&d(e),Pe(n),k&&d(L),k&&d(U),k&&d(V),k&&d(t),it($,k),k&&d(r),Pe(h,k),A=!1,ot(F)}}}function Pt(a){let e;return{c(){e=g("div"),this.h()},l(n){e=v(n,"DIV",{class:!0,style:!0}),b(e).forEach(d),this.h()},h(){var n;p(e,"class","progress-bar"),et(e,"background-color",(n=a[3].get(a[7].id))==null?void 0:n.color),et(e,"width",a[7].value*100/a[1].totals.negativeTotal+"%")},m(n,s){me(n,e,s)},p(n,s){var c;s&10&&et(e,"background-color",(c=n[3].get(n[7].id))==null?void 0:c.color),s&2&&et(e,"width",n[7].value*100/n[1].totals.negativeTotal+"%")},d(n){n&&d(e)}}}function Ir(a){let e,n,s,c,l,f=a[0]&&a[1]&&Vt(a);function D(y){a[6](y)}let o={name:"Account",repo:at,form:[[{prop:"color",type:"color",class:"is-one-quarter"},{prop:"name"}]]};return a[2]!==void 0&&(o.modal=a[2]),s=new gr({props:o}),ut.push(()=>dt(s,"modal",D)),{c(){e=g("div"),f&&f.c(),n=W(),Ne(s.$$.fragment),this.h()},l(y){e=v(y,"DIV",{class:!0});var u=b(e);f&&f.l(u),u.forEach(d),n=Q(y),Fe(s.$$.fragment,y),this.h()},h(){p(e,"class","box mb-0 is-fullheight")},m(y,u){me(y,e,u),f&&f.m(e,null),me(y,n,u),Ve(s,y,u),l=!0},p(y,[u]){y[0]&&y[1]?f?(f.p(y,u),u&3&&_e(f,1)):(f=Vt(y),f.c(),_e(f,1),f.m(e,null)):f&&(nt(),we(f,1,1,()=>{f=null}),st());const I={};!c&&u&4&&(c=!0,I.modal=y[2],ft(()=>c=!1)),s.$set(I)},i(y){l||(_e(f),_e(s.$$.fragment,y),l=!0)},o(y){we(f),we(s.$$.fragment,y),l=!1},d(y){y&&d(e),f&&f.d(),y&&d(n),Pe(s,y)}}}function Dr(a,e,n){let s;ze(a,ir,u=>n(3,s=u));function c(){Xt.show(`Are you sure you want to delete the account '${f.name}' and all linked transactions ?`,"Delete account","is-danger").then(u=>{u&&(at.remove(f.id),wr("/"))})}let l=null,{account:f=null}=e,{transactionsRecap:D=null}=e;const o=()=>l.show(f);function y(u){l=u,n(2,l)}return a.$$set=u=>{"account"in u&&n(0,f=u.account),"transactionsRecap"in u&&n(1,D=u.transactionsRecap)},[f,D,l,s,c,o,y]}class Cr extends Je{constructor(e){super(),Ge(this,e,Dr,Ir,Xe,{account:0,transactionsRecap:1})}}function Bt(a,e,n){const s=a.slice();return s[7]=e[n],s}function Lt(a){let e,n,s,c,l=a[7].name+"",f,D,o,y,u;s=new Zt({props:{categoryId:a[7].id}});function I(){return a[4](a[7])}return{c(){e=g("a"),n=g("span"),Ne(s.$$.fragment),c=W(),f=ve(l),D=W(),this.h()},l(m){e=v(m,"A",{class:!0});var T=b(e);n=v(T,"SPAN",{class:!0});var H=b(n);Fe(s.$$.fragment,H),H.forEach(d),c=Q(T),f=be(T,l),D=Q(T),T.forEach(d),this.h()},h(){p(n,"class","panel-icon"),p(e,"class","panel-block")},m(m,T){me(m,e,T),i(e,n),Ve(s,n,null),i(e,c),i(e,f),i(e,D),o=!0,y||(u=De(e,"click",I),y=!0)},p(m,T){a=m;const H={};T&2&&(H.categoryId=a[7].id),s.$set(H),(!o||T&2)&&l!==(l=a[7].name+"")&&Ye(f,l)},i(m){o||(_e(s.$$.fragment,m),o=!0)},o(m){we(s.$$.fragment,m),o=!1},d(m){m&&d(e),Pe(s),y=!1,u()}}}function Tr(a){let e,n,s,c,l,f,D,o,y,u,I,m,T,H,j=a[1],C=[];for(let S=0;S<j.length;S+=1)C[S]=Lt(Bt(a,j,S));const P=S=>we(C[S],1,1,()=>{C[S]=null});return{c(){e=g("div"),n=g("div"),s=W(),c=g("div"),l=g("div"),f=g("div"),D=g("span"),o=ve("Select a category"),y=W();for(let S=0;S<C.length;S+=1)C[S].c();u=W(),I=g("button"),this.h()},l(S){e=v(S,"DIV",{class:!0});var L=b(e);n=v(L,"DIV",{class:!0}),b(n).forEach(d),s=Q(L),c=v(L,"DIV",{class:!0});var U=b(c);l=v(U,"DIV",{class:!0});var oe=b(l);f=v(oe,"DIV",{class:!0});var ae=b(f);D=v(ae,"SPAN",{class:!0});var V=b(D);o=be(V,"Select a category"),V.forEach(d),ae.forEach(d),y=Q(oe);for(let t=0;t<C.length;t+=1)C[t].l(oe);oe.forEach(d),U.forEach(d),u=Q(L),I=v(L,"BUTTON",{class:!0,"aria-label":!0}),b(I).forEach(d),L.forEach(d),this.h()},h(){p(n,"class","modal-background"),p(D,"class","has-text-grey-lighter"),p(f,"class","panel-block"),p(l,"class","panel has-background-white"),p(c,"class","modal-content"),p(I,"class","modal-close is-large"),p(I,"aria-label","close"),p(e,"class","modal"),He(e,"is-active",a[0])},m(S,L){me(S,e,L),i(e,n),i(e,s),i(e,c),i(c,l),i(l,f),i(f,D),i(D,o),i(l,y);for(let U=0;U<C.length;U+=1)C[U]&&C[U].m(l,null);i(e,u),i(e,I),m=!0,T||(H=De(e,"closing",a[5]),T=!0)},p(S,[L]){if(L&6){j=S[1];let U;for(U=0;U<j.length;U+=1){const oe=Bt(S,j,U);C[U]?(C[U].p(oe,L),_e(C[U],1)):(C[U]=Lt(oe),C[U].c(),_e(C[U],1),C[U].m(l,null))}for(nt(),U=j.length;U<C.length;U+=1)P(U);st()}(!m||L&1)&&He(e,"is-active",S[0])},i(S){if(!m){for(let L=0;L<j.length;L+=1)_e(C[L]);m=!0}},o(S){C=C.filter(Boolean);for(let L=0;L<C.length;L+=1)we(C[L]);m=!1},d(S){S&&d(e),it(C,S),T=!1,H()}}}function Ar(a,e,n){let s;ze(a,or,u=>n(1,s=u));function c(u){f(u),n(0,l=!1)}let l=!1,f=null;return[l,s,c,{show(){return n(0,l=!0),new Promise(function(u,I){f=u})}},u=>{c(u)},()=>{n(0,l=!1)}]}class Rr extends Je{constructor(e){super(),Ge(this,e,Ar,Tr,Xe,{modal:3})}get modal(){return this.$$.ctx[3]}}var Or=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Sr(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var rr={exports:{}};/* @license
Papa Parse
v5.4.1
https://github.com/mholt/PapaParse
License: MIT
*/(function(a,e){(function(n,s){a.exports=s()})(Or,function n(){var s=typeof self<"u"?self:typeof window<"u"?window:s!==void 0?s:{},c=!s.document&&!!s.postMessage,l=s.IS_PAPA_WORKER||!1,f={},D=0,o={parse:function(t,r){var h=(r=r||{}).dynamicTyping||!1;if(V(h)&&(r.dynamicTypingFunction=h,h={}),r.dynamicTyping=h,r.transform=!!V(r.transform)&&r.transform,r.worker&&o.WORKERS_SUPPORTED){var w=function(){if(!o.WORKERS_SUPPORTED)return!1;var F=($=s.URL||s.webkitURL||null,k=n.toString(),o.BLOB_URL||(o.BLOB_URL=$.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",k,")();"],{type:"text/javascript"})))),_=new s.Worker(F),$,k;return _.onmessage=S,_.id=D++,f[_.id]=_}();return w.userStep=r.step,w.userChunk=r.chunk,w.userComplete=r.complete,w.userError=r.error,r.step=V(r.step),r.chunk=V(r.chunk),r.complete=V(r.complete),r.error=V(r.error),delete r.worker,void w.postMessage({input:t,config:r,workerId:w.id})}var A=null;return o.NODE_STREAM_INPUT,typeof t=="string"?(t=function(F){return F.charCodeAt(0)===65279?F.slice(1):F}(t),A=r.download?new I(r):new T(r)):t.readable===!0&&V(t.read)&&V(t.on)?A=new H(r):(s.File&&t instanceof File||t instanceof Object)&&(A=new m(r)),A.stream(t)},unparse:function(t,r){var h=!1,w=!0,A=",",F=`\r
`,_='"',$=_+_,k=!1,E=null,z=!1;(function(){if(typeof r=="object"){if(typeof r.delimiter!="string"||o.BAD_DELIMITERS.filter(function(O){return r.delimiter.indexOf(O)!==-1}).length||(A=r.delimiter),(typeof r.quotes=="boolean"||typeof r.quotes=="function"||Array.isArray(r.quotes))&&(h=r.quotes),typeof r.skipEmptyLines!="boolean"&&typeof r.skipEmptyLines!="string"||(k=r.skipEmptyLines),typeof r.newline=="string"&&(F=r.newline),typeof r.quoteChar=="string"&&(_=r.quoteChar),typeof r.header=="boolean"&&(w=r.header),Array.isArray(r.columns)){if(r.columns.length===0)throw new Error("Option columns is empty");E=r.columns}r.escapeChar!==void 0&&($=r.escapeChar+_),(typeof r.escapeFormulae=="boolean"||r.escapeFormulae instanceof RegExp)&&(z=r.escapeFormulae instanceof RegExp?r.escapeFormulae:/^[=+\-@\t\r].*$/)}})();var M=new RegExp(C(_),"g");if(typeof t=="string"&&(t=JSON.parse(t)),Array.isArray(t)){if(!t.length||Array.isArray(t[0]))return q(null,t,k);if(typeof t[0]=="object")return q(E||Object.keys(t[0]),t,k)}else if(typeof t=="object")return typeof t.data=="string"&&(t.data=JSON.parse(t.data)),Array.isArray(t.data)&&(t.fields||(t.fields=t.meta&&t.meta.fields||E),t.fields||(t.fields=Array.isArray(t.data[0])?t.fields:typeof t.data[0]=="object"?Object.keys(t.data[0]):[]),Array.isArray(t.data[0])||typeof t.data[0]=="object"||(t.data=[t.data])),q(t.fields||[],t.data||[],k);throw new Error("Unable to serialize unrecognized input");function q(O,Y,J){var te="";typeof O=="string"&&(O=JSON.parse(O)),typeof Y=="string"&&(Y=JSON.parse(Y));var le=Array.isArray(O)&&0<O.length,ue=!Array.isArray(Y[0]);if(le&&w){for(var re=0;re<O.length;re++)0<re&&(te+=A),te+=ee(O[re],re);0<Y.length&&(te+=F)}for(var R=0;R<Y.length;R++){var B=le?O.length:Y[R].length,K=!1,se=le?Object.keys(Y[R]).length===0:Y[R].length===0;if(J&&!le&&(K=J==="greedy"?Y[R].join("").trim()==="":Y[R].length===1&&Y[R][0].length===0),J==="greedy"&&le){for(var x=[],fe=0;fe<B;fe++){var ne=ue?O[fe]:fe;x.push(Y[R][ne])}K=x.join("").trim()===""}if(!K){for(var Z=0;Z<B;Z++){0<Z&&!se&&(te+=A);var ge=le&&ue?O[Z]:Z;te+=ee(Y[R][ge],Z)}R<Y.length-1&&(!J||0<B&&!se)&&(te+=F)}}return te}function ee(O,Y){if(O==null)return"";if(O.constructor===Date)return JSON.stringify(O).slice(1,25);var J=!1;z&&typeof O=="string"&&z.test(O)&&(O="'"+O,J=!0);var te=O.toString().replace(M,$);return(J=J||h===!0||typeof h=="function"&&h(O,Y)||Array.isArray(h)&&h[Y]||function(le,ue){for(var re=0;re<ue.length;re++)if(-1<le.indexOf(ue[re]))return!0;return!1}(te,o.BAD_DELIMITERS)||-1<te.indexOf(A)||te.charAt(0)===" "||te.charAt(te.length-1)===" ")?_+te+_:te}}};if(o.RECORD_SEP=String.fromCharCode(30),o.UNIT_SEP=String.fromCharCode(31),o.BYTE_ORDER_MARK="\uFEFF",o.BAD_DELIMITERS=["\r",`
`,'"',o.BYTE_ORDER_MARK],o.WORKERS_SUPPORTED=!c&&!!s.Worker,o.NODE_STREAM_INPUT=1,o.LocalChunkSize=10485760,o.RemoteChunkSize=5242880,o.DefaultDelimiter=",",o.Parser=P,o.ParserHandle=j,o.NetworkStreamer=I,o.FileStreamer=m,o.StringStreamer=T,o.ReadableStreamStreamer=H,s.jQuery){var y=s.jQuery;y.fn.parse=function(t){var r=t.config||{},h=[];return this.each(function(F){if(!(y(this).prop("tagName").toUpperCase()==="INPUT"&&y(this).attr("type").toLowerCase()==="file"&&s.FileReader)||!this.files||this.files.length===0)return!0;for(var _=0;_<this.files.length;_++)h.push({file:this.files[_],inputElem:this,instanceConfig:y.extend({},r)})}),w(),this;function w(){if(h.length!==0){var F,_,$,k,E=h[0];if(V(t.before)){var z=t.before(E.file,E.inputElem);if(typeof z=="object"){if(z.action==="abort")return F="AbortError",_=E.file,$=E.inputElem,k=z.reason,void(V(t.error)&&t.error({name:F},_,$,k));if(z.action==="skip")return void A();typeof z.config=="object"&&(E.instanceConfig=y.extend(E.instanceConfig,z.config))}else if(z==="skip")return void A()}var M=E.instanceConfig.complete;E.instanceConfig.complete=function(q){V(M)&&M(q,E.file,E.inputElem),A()},o.parse(E.file,E.instanceConfig)}else V(t.complete)&&t.complete()}function A(){h.splice(0,1),w()}}}function u(t){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(r){var h=oe(r);h.chunkSize=parseInt(h.chunkSize),r.step||r.chunk||(h.chunkSize=null),this._handle=new j(h),(this._handle.streamer=this)._config=h}.call(this,t),this.parseChunk=function(r,h){if(this.isFirstChunk&&V(this._config.beforeFirstChunk)){var w=this._config.beforeFirstChunk(r);w!==void 0&&(r=w)}this.isFirstChunk=!1,this._halted=!1;var A=this._partialLine+r;this._partialLine="";var F=this._handle.parse(A,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var _=F.meta.cursor;this._finished||(this._partialLine=A.substring(_-this._baseIndex),this._baseIndex=_),F&&F.data&&(this._rowCount+=F.data.length);var $=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(l)s.postMessage({results:F,workerId:o.WORKER_ID,finished:$});else if(V(this._config.chunk)&&!h){if(this._config.chunk(F,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);F=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(F.data),this._completeResults.errors=this._completeResults.errors.concat(F.errors),this._completeResults.meta=F.meta),this._completed||!$||!V(this._config.complete)||F&&F.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),$||F&&F.meta.paused||this._nextChunk(),F}this._halted=!0},this._sendError=function(r){V(this._config.error)?this._config.error(r):l&&this._config.error&&s.postMessage({workerId:o.WORKER_ID,error:r,finished:!1})}}function I(t){var r;(t=t||{}).chunkSize||(t.chunkSize=o.RemoteChunkSize),u.call(this,t),this._nextChunk=c?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(h){this._input=h,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(r=new XMLHttpRequest,this._config.withCredentials&&(r.withCredentials=this._config.withCredentials),c||(r.onload=ae(this._chunkLoaded,this),r.onerror=ae(this._chunkError,this)),r.open(this._config.downloadRequestBody?"POST":"GET",this._input,!c),this._config.downloadRequestHeaders){var h=this._config.downloadRequestHeaders;for(var w in h)r.setRequestHeader(w,h[w])}if(this._config.chunkSize){var A=this._start+this._config.chunkSize-1;r.setRequestHeader("Range","bytes="+this._start+"-"+A)}try{r.send(this._config.downloadRequestBody)}catch(F){this._chunkError(F.message)}c&&r.status===0&&this._chunkError()}},this._chunkLoaded=function(){r.readyState===4&&(r.status<200||400<=r.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:r.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(h){var w=h.getResponseHeader("Content-Range");return w===null?-1:parseInt(w.substring(w.lastIndexOf("/")+1))}(r),this.parseChunk(r.responseText)))},this._chunkError=function(h){var w=r.statusText||h;this._sendError(new Error(w))}}function m(t){var r,h;(t=t||{}).chunkSize||(t.chunkSize=o.LocalChunkSize),u.call(this,t);var w=typeof FileReader<"u";this.stream=function(A){this._input=A,h=A.slice||A.webkitSlice||A.mozSlice,w?((r=new FileReader).onload=ae(this._chunkLoaded,this),r.onerror=ae(this._chunkError,this)):r=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var A=this._input;if(this._config.chunkSize){var F=Math.min(this._start+this._config.chunkSize,this._input.size);A=h.call(A,this._start,F)}var _=r.readAsText(A,this._config.encoding);w||this._chunkLoaded({target:{result:_}})},this._chunkLoaded=function(A){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(A.target.result)},this._chunkError=function(){this._sendError(r.error)}}function T(t){var r;u.call(this,t=t||{}),this.stream=function(h){return r=h,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var h,w=this._config.chunkSize;return w?(h=r.substring(0,w),r=r.substring(w)):(h=r,r=""),this._finished=!r,this.parseChunk(h)}}}function H(t){u.call(this,t=t||{});var r=[],h=!0,w=!1;this.pause=function(){u.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){u.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(A){this._input=A,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){w&&r.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),r.length?this.parseChunk(r.shift()):h=!0},this._streamData=ae(function(A){try{r.push(typeof A=="string"?A:A.toString(this._config.encoding)),h&&(h=!1,this._checkIsFinished(),this.parseChunk(r.shift()))}catch(F){this._streamError(F)}},this),this._streamError=ae(function(A){this._streamCleanUp(),this._sendError(A)},this),this._streamEnd=ae(function(){this._streamCleanUp(),w=!0,this._streamData("")},this),this._streamCleanUp=ae(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function j(t){var r,h,w,A=Math.pow(2,53),F=-A,_=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,$=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,k=this,E=0,z=0,M=!1,q=!1,ee=[],O={data:[],errors:[],meta:{}};if(V(t.step)){var Y=t.step;t.step=function(R){if(O=R,le())te();else{if(te(),O.data.length===0)return;E+=R.data.length,t.preview&&E>t.preview?h.abort():(O.data=O.data[0],Y(O,k))}}}function J(R){return t.skipEmptyLines==="greedy"?R.join("").trim()==="":R.length===1&&R[0].length===0}function te(){return O&&w&&(re("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+o.DefaultDelimiter+"'"),w=!1),t.skipEmptyLines&&(O.data=O.data.filter(function(R){return!J(R)})),le()&&function(){if(!O)return;function R(K,se){V(t.transformHeader)&&(K=t.transformHeader(K,se)),ee.push(K)}if(Array.isArray(O.data[0])){for(var B=0;le()&&B<O.data.length;B++)O.data[B].forEach(R);O.data.splice(0,1)}else O.data.forEach(R)}(),function(){if(!O||!t.header&&!t.dynamicTyping&&!t.transform)return O;function R(K,se){var x,fe=t.header?{}:[];for(x=0;x<K.length;x++){var ne=x,Z=K[x];t.header&&(ne=x>=ee.length?"__parsed_extra":ee[x]),t.transform&&(Z=t.transform(Z,ne)),Z=ue(ne,Z),ne==="__parsed_extra"?(fe[ne]=fe[ne]||[],fe[ne].push(Z)):fe[ne]=Z}return t.header&&(x>ee.length?re("FieldMismatch","TooManyFields","Too many fields: expected "+ee.length+" fields but parsed "+x,z+se):x<ee.length&&re("FieldMismatch","TooFewFields","Too few fields: expected "+ee.length+" fields but parsed "+x,z+se)),fe}var B=1;return!O.data.length||Array.isArray(O.data[0])?(O.data=O.data.map(R),B=O.data.length):O.data=R(O.data,0),t.header&&O.meta&&(O.meta.fields=ee),z+=B,O}()}function le(){return t.header&&ee.length===0}function ue(R,B){return K=R,t.dynamicTypingFunction&&t.dynamicTyping[K]===void 0&&(t.dynamicTyping[K]=t.dynamicTypingFunction(K)),(t.dynamicTyping[K]||t.dynamicTyping)===!0?B==="true"||B==="TRUE"||B!=="false"&&B!=="FALSE"&&(function(se){if(_.test(se)){var x=parseFloat(se);if(F<x&&x<A)return!0}return!1}(B)?parseFloat(B):$.test(B)?new Date(B):B===""?null:B):B;var K}function re(R,B,K,se){var x={type:R,code:B,message:K};se!==void 0&&(x.row=se),O.errors.push(x)}this.parse=function(R,B,K){var se=t.quoteChar||'"';if(t.newline||(t.newline=function(ne,Z){ne=ne.substring(0,1048576);var ge=new RegExp(C(Z)+"([^]*?)"+C(Z),"gm"),ke=(ne=ne.replace(ge,"")).split("\r"),Ce=ne.split(`
`),Te=1<Ce.length&&Ce[0].length<ke[0].length;if(ke.length===1||Te)return`
`;for(var he=0,ce=0;ce<ke.length;ce++)ke[ce][0]===`
`&&he++;return he>=ke.length/2?`\r
`:"\r"}(R,se)),w=!1,t.delimiter)V(t.delimiter)&&(t.delimiter=t.delimiter(R),O.meta.delimiter=t.delimiter);else{var x=function(ne,Z,ge,ke,Ce){var Te,he,ce,de;Ce=Ce||[",","	","|",";",o.RECORD_SEP,o.UNIT_SEP];for(var Ee=0;Ee<Ce.length;Ee++){var G=Ce[Ee],pe=0,Re=0,Se=0;ce=void 0;for(var ye=new P({comments:ke,delimiter:G,newline:Z,preview:10}).parse(ne),X=0;X<ye.data.length;X++)if(ge&&J(ye.data[X]))Se++;else{var $e=ye.data[X].length;Re+=$e,ce!==void 0?0<$e&&(pe+=Math.abs($e-ce),ce=$e):ce=$e}0<ye.data.length&&(Re/=ye.data.length-Se),(he===void 0||pe<=he)&&(de===void 0||de<Re)&&1.99<Re&&(he=pe,Te=G,de=Re)}return{successful:!!(t.delimiter=Te),bestDelimiter:Te}}(R,t.newline,t.skipEmptyLines,t.comments,t.delimitersToGuess);x.successful?t.delimiter=x.bestDelimiter:(w=!0,t.delimiter=o.DefaultDelimiter),O.meta.delimiter=t.delimiter}var fe=oe(t);return t.preview&&t.header&&fe.preview++,r=R,h=new P(fe),O=h.parse(r,B,K),te(),M?{meta:{paused:!0}}:O||{meta:{paused:!1}}},this.paused=function(){return M},this.pause=function(){M=!0,h.abort(),r=V(t.chunk)?"":r.substring(h.getCharIndex())},this.resume=function(){k.streamer._halted?(M=!1,k.streamer.parseChunk(r,!0)):setTimeout(k.resume,3)},this.aborted=function(){return q},this.abort=function(){q=!0,h.abort(),O.meta.aborted=!0,V(t.complete)&&t.complete(O),r=""}}function C(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function P(t){var r,h=(t=t||{}).delimiter,w=t.newline,A=t.comments,F=t.step,_=t.preview,$=t.fastMode,k=r=t.quoteChar===void 0||t.quoteChar===null?'"':t.quoteChar;if(t.escapeChar!==void 0&&(k=t.escapeChar),(typeof h!="string"||-1<o.BAD_DELIMITERS.indexOf(h))&&(h=","),A===h)throw new Error("Comment character same as delimiter");A===!0?A="#":(typeof A!="string"||-1<o.BAD_DELIMITERS.indexOf(A))&&(A=!1),w!==`
`&&w!=="\r"&&w!==`\r
`&&(w=`
`);var E=0,z=!1;this.parse=function(M,q,ee){if(typeof M!="string")throw new Error("Input must be a string");var O=M.length,Y=h.length,J=w.length,te=A.length,le=V(F),ue=[],re=[],R=[],B=E=0;if(!M)return Ae();if(t.header&&!q){var K=M.split(w)[0].split(h),se=[],x={},fe=!1;for(var ne in K){var Z=K[ne];V(t.transformHeader)&&(Z=t.transformHeader(Z,ne));var ge=Z,ke=x[Z]||0;for(0<ke&&(fe=!0,ge=Z+"_"+ke),x[Z]=ke+1;se.includes(ge);)ge=ge+"_"+ke;se.push(ge)}if(fe){var Ce=M.split(w);Ce[0]=se.join(h),M=Ce.join(w)}}if($||$!==!1&&M.indexOf(r)===-1){for(var Te=M.split(w),he=0;he<Te.length;he++){if(R=Te[he],E+=R.length,he!==Te.length-1)E+=w.length;else if(ee)return Ae();if(!A||R.substring(0,te)!==A){if(le){if(ue=[],Se(R.split(h)),Ue(),z)return Ae()}else Se(R.split(h));if(_&&_<=he)return ue=ue.slice(0,_),Ae(!0)}}return Ae()}for(var ce=M.indexOf(h,E),de=M.indexOf(w,E),Ee=new RegExp(C(k)+C(r),"g"),G=M.indexOf(r,E);;)if(M[E]!==r)if(A&&R.length===0&&M.substring(E,E+te)===A){if(de===-1)return Ae();E=de+J,de=M.indexOf(w,E),ce=M.indexOf(h,E)}else if(ce!==-1&&(ce<de||de===-1))R.push(M.substring(E,ce)),E=ce+Y,ce=M.indexOf(h,E);else{if(de===-1)break;if(R.push(M.substring(E,de)),$e(de+J),le&&(Ue(),z))return Ae();if(_&&ue.length>=_)return Ae(!0)}else for(G=E,E++;;){if((G=M.indexOf(r,G+1))===-1)return ee||re.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:ue.length,index:E}),X();if(G===O-1)return X(M.substring(E,G).replace(Ee,r));if(r!==k||M[G+1]!==k){if(r===k||G===0||M[G-1]!==k){ce!==-1&&ce<G+1&&(ce=M.indexOf(h,G+1)),de!==-1&&de<G+1&&(de=M.indexOf(w,G+1));var pe=ye(de===-1?ce:Math.min(ce,de));if(M.substr(G+1+pe,Y)===h){R.push(M.substring(E,G).replace(Ee,r)),M[E=G+1+pe+Y]!==r&&(G=M.indexOf(r,E)),ce=M.indexOf(h,E),de=M.indexOf(w,E);break}var Re=ye(de);if(M.substring(G+1+Re,G+1+Re+J)===w){if(R.push(M.substring(E,G).replace(Ee,r)),$e(G+1+Re+J),ce=M.indexOf(h,E),G=M.indexOf(r,E),le&&(Ue(),z))return Ae();if(_&&ue.length>=_)return Ae(!0);break}re.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:ue.length,index:E}),G++}}else G++}return X();function Se(Oe){ue.push(Oe),B=E}function ye(Oe){var Ke=0;if(Oe!==-1){var N=M.substring(G+1,Oe);N&&N.trim()===""&&(Ke=N.length)}return Ke}function X(Oe){return ee||(Oe===void 0&&(Oe=M.substring(E)),R.push(Oe),E=O,Se(R),le&&Ue()),Ae()}function $e(Oe){E=Oe,Se(R),R=[],de=M.indexOf(w,E)}function Ae(Oe){return{data:ue,errors:re,meta:{delimiter:h,linebreak:w,aborted:z,truncated:!!Oe,cursor:B+(q||0)}}}function Ue(){F(Ae()),ue=[],re=[]}},this.abort=function(){z=!0},this.getCharIndex=function(){return E}}function S(t){var r=t.data,h=f[r.workerId],w=!1;if(r.error)h.userError(r.error,r.file);else if(r.results&&r.results.data){var A={abort:function(){w=!0,L(r.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:U,resume:U};if(V(h.userStep)){for(var F=0;F<r.results.data.length&&(h.userStep({data:r.results.data[F],errors:r.results.errors,meta:r.results.meta},A),!w);F++);delete r.results}else V(h.userChunk)&&(h.userChunk(r.results,A,r.file),delete r.results)}r.finished&&!w&&L(r.workerId,r.results)}function L(t,r){var h=f[t];V(h.userComplete)&&h.userComplete(r),h.terminate(),delete f[t]}function U(){throw new Error("Not implemented.")}function oe(t){if(typeof t!="object"||t===null)return t;var r=Array.isArray(t)?[]:{};for(var h in t)r[h]=oe(t[h]);return r}function ae(t,r){return function(){t.apply(r,arguments)}}function V(t){return typeof t=="function"}return l&&(s.onmessage=function(t){var r=t.data;if(o.WORKER_ID===void 0&&r&&(o.WORKER_ID=r.workerId),typeof r.input=="string")s.postMessage({workerId:o.WORKER_ID,results:o.parse(r.input,r.config),finished:!0});else if(s.File&&r.input instanceof File||r.input instanceof Object){var h=o.parse(r.input,r.config);h&&s.postMessage({workerId:o.WORKER_ID,results:h,finished:!0})}}),(I.prototype=Object.create(u.prototype)).constructor=I,(m.prototype=Object.create(u.prototype)).constructor=m,(T.prototype=Object.create(T.prototype)).constructor=T,(H.prototype=Object.create(u.prototype)).constructor=H,o})})(rr);var $r=rr.exports;const Mr=Sr($r),Nr={labanquepostale:{csv:{date:[3,1],dayTimespan:30,balance:[4,1],transactions:{startLine:7,dateCol:0,descriptionCol:1,valueCol:2}}}};function Fr(a){return new Promise((e,n)=>{Mr.parse(a,{delimiter:";",skipEmptyLines:!0,complete:function(s){e(s.data)},error:n})})}function zt(a){return parseFloat(a.replace(",","."))}function Ut(a){let e=a.split("/");return new Date(Date.UTC(parseInt(e[2],10),parseInt(e[1],10)-1,parseInt(e[0],10)))}function Vr(a,e,n){let s=[],c=zt(a[e.balance[0]][e.balance[1]].replace()),l=Ut(a[e.date[0]][e.date[1]]),f=new Date(l);f.setDate(f.getDate()-e.dayTimespan);for(let D=e.transactions.startLine;D<a.length;D++)s.push(new lr(Ut(a[D][e.transactions.dateCol]),a[D][e.transactions.descriptionCol].trim(),zt(a[D][e.transactions.valueCol])));return{balance:c,dateMin:f,dateMax:l,transactions:s}}async function Pr(a,e){switch(e.bank){case"labanquepostale":return Vr(await Fr(a),Nr[e.bank].csv,e.accountId)}}function Br(a,e,n){const s={};for(let c=n.length-1;c>=0;c--){let l=n[c];const f=l.date.toDateString();s[f]=s[f]+1||0,l.orderNumber=s[f],l.accountId=a}if(n.sort((c,l)=>l.date-c.date||l.orderNumber-c.orderNumber),!e)return n;if(n[0].date<=(e==null?void 0:e.date))return[];if(e){e.orderNumber+=1;let c=null;for(let l=n.length-1;l>=0;l--){if(n[l].date.getTime()==e.date.getTime()&&n[l].description==e.description&&n[l].value==e.value){n=n.slice(0,l);break}if(n[l].date.getTime()==e.date.getTime()&&(c||(c=l+1),n[l].orderNumber+=e.orderNumber),n[l].date>e.date){n=n.slice(0,c||l);break}}}return n}async function Lr(a,e){let{balance:n,dateMin:s,dateMax:c,transactions:l}=await Pr(a,e);const f=await We.getMostRecent(),D=Br(e.accountId,f,l);return D.length?(We.createAll(D),at.updateBalance(e.accountId,n),e.saveImportedFiles&&br.saveImportedTransactions(D),{count:D.length}):{count:0}}const zr={importTransactions:Lr};function qt(a){let e=a[1][0].name+"",n;return{c(){n=ve(e)},l(s){n=be(s,e)},m(s,c){me(s,n,c)},p(s,c){c&2&&e!==(e=s[1][0].name+"")&&Ye(n,e)},d(s){s&&d(n)}}}function Ur(a){let e,n,s,c,l,f,D,o,y,u,I,m,T,H,j,C,P,S,L,U,oe,ae,V,t,r,h,w,A,F,_,$,k,E,z,M,q,ee,O,Y,J,te,le,ue,re,R=a[1]&&a[1][0]&&qt(a);return{c(){e=g("div"),n=g("div"),s=W(),c=g("div"),l=g("header"),f=g("p"),D=ve("Import"),o=W(),y=g("button"),u=W(),I=g("section"),m=g("div"),T=g("label"),H=ve(`Bank\r
                    `),j=g("div"),C=g("div"),P=g("select"),S=g("option"),L=ve("La banque postal : CSV"),U=W(),oe=g("div"),ae=g("div"),V=g("div"),t=g("label"),r=g("input"),h=W(),w=g("span"),A=g("span"),F=g("i"),_=W(),$=g("span"),k=ve("Choose a file…"),E=W(),z=g("span"),R&&R.c(),M=W(),q=g("footer"),ee=g("button"),O=ve("Cancel"),Y=W(),J=g("button"),te=ve("Import"),this.h()},l(B){e=v(B,"DIV",{class:!0});var K=b(e);n=v(K,"DIV",{class:!0}),b(n).forEach(d),s=Q(K),c=v(K,"DIV",{class:!0});var se=b(c);l=v(se,"HEADER",{class:!0});var x=b(l);f=v(x,"P",{class:!0});var fe=b(f);D=be(fe,"Import"),fe.forEach(d),o=Q(x),y=v(x,"BUTTON",{class:!0,"aria-label":!0}),b(y).forEach(d),x.forEach(d),u=Q(se),I=v(se,"SECTION",{class:!0});var ne=b(I);m=v(ne,"DIV",{class:!0});var Z=b(m);T=v(Z,"LABEL",{class:!0});var ge=b(T);H=be(ge,`Bank\r
                    `),j=v(ge,"DIV",{class:!0});var ke=b(j);C=v(ke,"DIV",{class:!0});var Ce=b(C);P=v(Ce,"SELECT",{});var Te=b(P);S=v(Te,"OPTION",{});var he=b(S);L=be(he,"La banque postal : CSV"),he.forEach(d),Te.forEach(d),Ce.forEach(d),ke.forEach(d),ge.forEach(d),Z.forEach(d),U=Q(ne),oe=v(ne,"DIV",{class:!0});var ce=b(oe);ae=v(ce,"DIV",{class:!0});var de=b(ae);V=v(de,"DIV",{class:!0});var Ee=b(V);t=v(Ee,"LABEL",{class:!0});var G=b(t);r=v(G,"INPUT",{class:!0,type:!0,name:!0}),h=Q(G),w=v(G,"SPAN",{class:!0});var pe=b(w);A=v(pe,"SPAN",{class:!0});var Re=b(A);F=v(Re,"I",{class:!0}),b(F).forEach(d),Re.forEach(d),_=Q(pe),$=v(pe,"SPAN",{class:!0});var Se=b($);k=be(Se,"Choose a file…"),Se.forEach(d),pe.forEach(d),E=Q(G),z=v(G,"SPAN",{class:!0});var ye=b(z);R&&R.l(ye),ye.forEach(d),G.forEach(d),Ee.forEach(d),de.forEach(d),ce.forEach(d),ne.forEach(d),M=Q(se),q=v(se,"FOOTER",{class:!0});var X=b(q);ee=v(X,"BUTTON",{class:!0,"data-dismiss":!0});var $e=b(ee);O=be($e,"Cancel"),$e.forEach(d),Y=Q(X),J=v(X,"BUTTON",{class:!0});var Ae=b(J);te=be(Ae,"Import"),Ae.forEach(d),X.forEach(d),se.forEach(d),K.forEach(d),this.h()},h(){p(n,"class","modal-background"),p(f,"class","modal-card-title"),p(y,"class","delete"),p(y,"aria-label","close"),p(l,"class","modal-card-head"),S.__value="labanquepostale",S.value=S.__value,a[2]===void 0&&fr(()=>a[6].call(P)),p(C,"class","select is-fullwidth"),p(j,"class","control"),p(T,"class","label"),p(m,"class","field"),p(r,"class","file-input"),p(r,"type","file"),p(r,"name","resume"),p(F,"class","gg-software-upload"),p(A,"class","file-icon"),p($,"class","file-label"),p(w,"class","file-cta"),p(z,"class","file-name"),p(t,"class","file-label"),p(V,"class","file has-name is-boxed is-justify-content-center"),p(ae,"class","control"),p(oe,"class","field"),p(I,"class","modal-card-body"),p(ee,"class","button"),p(ee,"data-dismiss","modal"),p(J,"class","button is-success"),J.disabled=le=!jt(a[1]),p(q,"class","modal-card-foot is-justify-content-flex-end"),p(c,"class","modal-card"),p(e,"class","modal"),He(e,"is-active",!!a[0])},m(B,K){me(B,e,K),i(e,n),i(e,s),i(e,c),i(c,l),i(l,f),i(f,D),i(l,o),i(l,y),i(c,u),i(c,I),i(I,m),i(m,T),i(T,H),i(T,j),i(j,C),i(C,P),i(P,S),i(S,L),Ot(P,a[2],!0),i(I,U),i(I,oe),i(oe,ae),i(ae,V),i(V,t),i(t,r),i(t,h),i(t,w),i(w,A),i(A,F),i(w,_),i(w,$),i($,k),i(t,E),i(t,z),R&&R.m(z,null),i(c,M),i(c,q),i(q,ee),i(ee,O),i(q,Y),i(q,J),i(J,te),ue||(re=[De(P,"change",a[6]),De(r,"change",a[7]),De(J,"click",a[3]),De(e,"closing",a[4])],ue=!0)},p(B,[K]){K&4&&Ot(P,B[2]),B[1]&&B[1][0]?R?R.p(B,K):(R=qt(B),R.c(),R.m(z,null)):R&&(R.d(1),R=null),K&2&&le!==(le=!jt(B[1]))&&(J.disabled=le),K&1&&He(e,"is-active",!!B[0])},i:St,o:St,d(B){B&&d(e),R&&R.d(),ue=!1,ot(re)}}}function jt(a){return a&&a.length===1}function qr(a,e,n){let s;ze(a,cr,m=>n(8,s=m));async function c(){let m=await zr.importTransactions(f[0],{accountId:o,bank:D,saveImportedFiles:s.saveImportedFiles});m.count?Nt.success(`${m.count} new transactions imported.`):Nt.info("No new transaction imported."),l()}function l(){n(0,o=null)}let f,D="labanquepostale",{accountId:o=null}=e;const y={show(m=null){n(0,o=m)}};function u(){D=hr(this),n(2,D)}function I(){f=this.files,n(1,f)}return a.$$set=m=>{"accountId"in m&&n(0,o=m.accountId)},[o,f,D,c,l,y,u,I]}class jr extends Je{constructor(e){super(),Ge(this,e,qr,Ur,Xe,{accountId:0,modal:5})}get modal(){return this.$$.ctx[5]}}function Ht(a,e,n){const s=a.slice();return s[27]=e[n],s}function Kt(a,e,n){const s=a.slice();return s[30]=e[n],s}function Wt(a){let e,n,s,c,l,f=a[30].description+"",D,o,y,u,I,m,T;s=new Zt({props:{categoryId:a[30].categoryId,selected:a[30].selected}}),y=new Yt({props:{value:a[30].value}});function H(){return a[20](a[30])}function j(...C){return a[21](a[30],...C)}return{c(){e=g("a"),n=g("span"),Ne(s.$$.fragment),c=W(),l=g("div"),D=ve(f),o=W(),Ne(y.$$.fragment),u=W(),this.h()},l(C){e=v(C,"A",{class:!0});var P=b(e);n=v(P,"SPAN",{class:!0});var S=b(n);Fe(s.$$.fragment,S),S.forEach(d),c=Q(P),l=v(P,"DIV",{class:!0});var L=b(l);D=be(L,f),o=Q(L),Fe(y.$$.fragment,L),L.forEach(d),u=Q(P),P.forEach(d),this.h()},h(){p(n,"class","panel-icon"),p(l,"class","flex-container"),p(e,"class","panel-block")},m(C,P){me(C,e,P),i(e,n),Ve(s,n,null),i(e,c),i(e,l),i(l,D),i(l,o),Ve(y,l,null),i(e,u),I=!0,m||(T=[De(e,"click",H),De(e,"contextmenu",pr(j))],m=!0)},p(C,P){a=C;const S={};P[0]&2&&(S.categoryId=a[30].categoryId),P[0]&2&&(S.selected=a[30].selected),s.$set(S),(!I||P[0]&2)&&f!==(f=a[30].description+"")&&Ye(D,f);const L={};P[0]&2&&(L.value=a[30].value),y.$set(L)},i(C){I||(_e(s.$$.fragment,C),_e(y.$$.fragment,C),I=!0)},o(C){we(s.$$.fragment,C),we(y.$$.fragment,C),I=!1},d(C){C&&d(e),Pe(s),Pe(y),m=!1,ot(T)}}}function Qt(a){let e,n=a[27].date.toLocaleDateString()+"",s,c,l,f,D=a[27].transactions,o=[];for(let u=0;u<D.length;u+=1)o[u]=Wt(Kt(a,D,u));const y=u=>we(o[u],1,1,()=>{o[u]=null});return{c(){e=g("div"),s=ve(n),c=W();for(let u=0;u<o.length;u+=1)o[u].c();l=$t(),this.h()},l(u){e=v(u,"DIV",{class:!0});var I=b(e);s=be(I,n),I.forEach(d),c=Q(u);for(let m=0;m<o.length;m+=1)o[m].l(u);l=$t(),this.h()},h(){p(e,"class","panel-block has-text-grey-light has-background-light")},m(u,I){me(u,e,I),i(e,s),me(u,c,I);for(let m=0;m<o.length;m+=1)o[m]&&o[m].m(u,I);me(u,l,I),f=!0},p(u,I){if((!f||I[0]&2)&&n!==(n=u[27].date.toLocaleDateString()+"")&&Ye(s,n),I[0]&2178){D=u[27].transactions;let m;for(m=0;m<D.length;m+=1){const T=Kt(u,D,m);o[m]?(o[m].p(T,I),_e(o[m],1)):(o[m]=Wt(T),o[m].c(),_e(o[m],1),o[m].m(l.parentNode,l))}for(nt(),m=D.length;m<o.length;m+=1)y(m);st()}},i(u){if(!f){for(let I=0;I<D.length;I+=1)_e(o[I]);f=!0}},o(u){o=o.filter(Boolean);for(let I=0;I<o.length;I+=1)we(o[I]);f=!1},d(u){u&&d(e),u&&d(c),it(o,u),u&&d(l)}}}function Hr(a){let e,n,s,c,l,f,D,o,y,u,I,m,T,H,j,C,P,S,L,U,oe,ae,V,t,r,h,w,A,F,_,$,k,E,z,M,q,ee,O,Y,J,te,le,ue,re,R,B,K,se,x,fe,ne,Z,ge,ke,Ce,Te,he,ce,de,Ee,G,pe,Re,Se,ye=a[1],X=[];for(let N=0;N<ye.length;N+=1)X[N]=Qt(Ht(a,ye,N));const $e=N=>we(X[N],1,1,()=>{X[N]=null});function Ae(N){a[22](N)}let Ue={};a[2]!==void 0&&(Ue.modal=a[2]),he=new Rr({props:Ue}),ut.push(()=>dt(he,"modal",Ae));function Oe(N){a[23](N)}let Ke={};return a[3]!==void 0&&(Ke.modal=a[3]),Ee=new jr({props:Ke}),ut.push(()=>dt(Ee,"modal",Oe)),{c(){e=g("nav"),n=g("div"),s=g("div"),c=g("input"),D=W(),o=g("span"),y=ve("Transactions"),u=W(),I=g("div"),m=g("button"),T=g("span"),H=g("i"),j=W(),C=g("div"),P=g("div"),S=g("button"),L=g("span"),U=g("i"),oe=W(),ae=g("div"),V=g("div"),t=g("a"),r=ve("Current month"),w=W(),A=g("a"),F=ve("1 month"),$=W(),k=g("a"),E=ve("6 month"),M=W(),q=g("a"),ee=ve("1 year"),Y=W(),J=g("a"),te=ve("All"),ue=W(),re=g("div"),R=g("div"),B=g("button"),K=g("span"),se=g("i"),x=W(),fe=g("div"),ne=g("div"),Z=g("a"),ge=g("i"),ke=ve(" Import transactions"),Ce=W();for(let N=0;N<X.length;N+=1)X[N].c();Te=W(),Ne(he.$$.fragment),de=W(),Ne(Ee.$$.fragment),this.h()},l(N){e=v(N,"NAV",{class:!0});var ie=b(e);n=v(ie,"DIV",{class:!0});var Me=b(n);s=v(Me,"DIV",{});var qe=b(s);c=v(qe,"INPUT",{class:!0,type:!0}),D=Q(qe),o=v(qe,"SPAN",{class:!0});var Ie=b(o);y=be(Ie,"Transactions"),Ie.forEach(d),qe.forEach(d),u=Q(Me),I=v(Me,"DIV",{});var Le=b(I);m=v(Le,"BUTTON",{class:!0,title:!0});var pt=b(m);T=v(pt,"SPAN",{class:!0});var mt=b(T);H=v(mt,"I",{class:!0}),b(H).forEach(d),mt.forEach(d),pt.forEach(d),j=Q(Le),C=v(Le,"DIV",{class:!0});var Ze=b(C);P=v(Ze,"DIV",{class:!0});var _t=b(P);S=v(_t,"BUTTON",{class:!0,"aria-haspopup":!0});var gt=b(S);L=v(gt,"SPAN",{class:!0});var vt=b(L);U=v(vt,"I",{class:!0}),b(U).forEach(d),vt.forEach(d),gt.forEach(d),_t.forEach(d),oe=Q(Ze),ae=v(Ze,"DIV",{class:!0,role:!0});var bt=b(ae);V=v(bt,"DIV",{class:!0});var Be=b(V);t=v(Be,"A",{class:!0});var Et=b(t);r=be(Et,"Current month"),Et.forEach(d),w=Q(Be),A=v(Be,"A",{class:!0});var kt=b(A);F=be(kt,"1 month"),kt.forEach(d),$=Q(Be),k=v(Be,"A",{class:!0});var yt=b(k);E=be(yt,"6 month"),yt.forEach(d),M=Q(Be),q=v(Be,"A",{class:!0});var wt=b(q);ee=be(wt,"1 year"),wt.forEach(d),Y=Q(Be),J=v(Be,"A",{class:!0});var It=b(J);te=be(It,"All"),It.forEach(d),Be.forEach(d),bt.forEach(d),Ze.forEach(d),ue=Q(Le),re=v(Le,"DIV",{class:!0});var xe=b(re);R=v(xe,"DIV",{class:!0});var Dt=b(R);B=v(Dt,"BUTTON",{class:!0,"aria-haspopup":!0});var Ct=b(B);K=v(Ct,"SPAN",{class:!0});var Tt=b(K);se=v(Tt,"I",{class:!0}),b(se).forEach(d),Tt.forEach(d),Ct.forEach(d),Dt.forEach(d),x=Q(xe),fe=v(xe,"DIV",{class:!0,role:!0});var At=b(fe);ne=v(At,"DIV",{class:!0});var Rt=b(ne);Z=v(Rt,"A",{class:!0});var lt=b(Z);ge=v(lt,"I",{class:!0}),b(ge).forEach(d),ke=be(lt," Import transactions"),lt.forEach(d),Rt.forEach(d),At.forEach(d),xe.forEach(d),Le.forEach(d),Me.forEach(d),Ce=Q(ie);for(let ct=0;ct<X.length;ct+=1)X[ct].l(ie);ie.forEach(d),Te=Q(N),Fe(he.$$.fragment,N),de=Q(N),Fe(Ee.$$.fragment,N),this.h()},h(){p(c,"class","mr-0"),p(c,"type","checkbox"),c.indeterminate=l=a[5].size>0&&a[5].size<a[0].length,c.checked=f=a[5].size==a[0].length,p(o,"class","has-text-grey-lighter"),p(H,"class","fa-solid fa-eye"),p(T,"class","icon is-small"),p(m,"class","button is-white is-small"),p(m,"title","Filter recap on selected transactions only"),He(m,"has-text-grey-light",!a[6]),p(U,"class","fa-solid fa-filter"),p(L,"class","icon is-small"),p(S,"class","button is-small is-light"),p(S,"aria-haspopup","true"),p(P,"class","dropdown-trigger"),p(t,"class",h="dropdown-item "+(a[4]==0?"is-active":"")),p(A,"class",_="dropdown-item "+(a[4]==1?"is-active":"")),p(k,"class",z="dropdown-item "+(a[4]==6?"is-active":"")),p(q,"class",O="dropdown-item "+(a[4]==12?"is-active":"")),p(J,"class",le="dropdown-item "+(a[4]==-1?"is-active":"")),p(V,"class","dropdown-content"),p(ae,"class","dropdown-menu"),p(ae,"role","menu"),p(C,"class","dropdown is-right"),p(se,"class","fa-solid fa-ellipsis-vertical"),p(K,"class","icon is-small"),p(B,"class","button is-small is-light"),p(B,"aria-haspopup","true"),p(R,"class","dropdown-trigger"),p(ge,"class","fa-solid fa-file-import"),p(Z,"class","dropdown-item"),p(ne,"class","dropdown-content"),p(fe,"class","dropdown-menu"),p(fe,"role","menu"),p(re,"class","dropdown is-right"),p(n,"class","panel-block flex-container"),p(e,"class","panel")},m(N,ie){me(N,e,ie),i(e,n),i(n,s),i(s,c),i(s,D),i(s,o),i(o,y),i(n,u),i(n,I),i(I,m),i(m,T),i(T,H),i(I,j),i(I,C),i(C,P),i(P,S),i(S,L),i(L,U),i(C,oe),i(C,ae),i(ae,V),i(V,t),i(t,r),i(V,w),i(V,A),i(A,F),i(V,$),i(V,k),i(k,E),i(V,M),i(V,q),i(q,ee),i(V,Y),i(V,J),i(J,te),i(I,ue),i(I,re),i(re,R),i(R,B),i(B,K),i(K,se),i(re,x),i(re,fe),i(fe,ne),i(ne,Z),i(Z,ge),i(Z,ke),i(e,Ce);for(let Me=0;Me<X.length;Me+=1)X[Me]&&X[Me].m(e,null);me(N,Te,ie),Ve(he,N,ie),me(N,de,ie),Ve(Ee,N,ie),pe=!0,Re||(Se=[De(c,"change",a[13]),De(m,"click",a[14]),De(t,"click",a[15]),De(A,"click",a[16]),De(k,"click",a[17]),De(q,"click",a[18]),De(J,"click",a[19]),De(Z,"click",a[8])],Re=!0)},p(N,ie){if((!pe||ie[0]&33&&l!==(l=N[5].size>0&&N[5].size<N[0].length))&&(c.indeterminate=l),(!pe||ie[0]&33&&f!==(f=N[5].size==N[0].length))&&(c.checked=f),(!pe||ie[0]&64)&&He(m,"has-text-grey-light",!N[6]),(!pe||ie[0]&16&&h!==(h="dropdown-item "+(N[4]==0?"is-active":"")))&&p(t,"class",h),(!pe||ie[0]&16&&_!==(_="dropdown-item "+(N[4]==1?"is-active":"")))&&p(A,"class",_),(!pe||ie[0]&16&&z!==(z="dropdown-item "+(N[4]==6?"is-active":"")))&&p(k,"class",z),(!pe||ie[0]&16&&O!==(O="dropdown-item "+(N[4]==12?"is-active":"")))&&p(q,"class",O),(!pe||ie[0]&16&&le!==(le="dropdown-item "+(N[4]==-1?"is-active":"")))&&p(J,"class",le),ie[0]&2178){ye=N[1];let Ie;for(Ie=0;Ie<ye.length;Ie+=1){const Le=Ht(N,ye,Ie);X[Ie]?(X[Ie].p(Le,ie),_e(X[Ie],1)):(X[Ie]=Qt(Le),X[Ie].c(),_e(X[Ie],1),X[Ie].m(e,null))}for(nt(),Ie=ye.length;Ie<X.length;Ie+=1)$e(Ie);st()}const Me={};!ce&&ie[0]&4&&(ce=!0,Me.modal=N[2],ft(()=>ce=!1)),he.$set(Me);const qe={};!G&&ie[0]&8&&(G=!0,qe.modal=N[3],ft(()=>G=!1)),Ee.$set(qe)},i(N){if(!pe){for(let ie=0;ie<ye.length;ie+=1)_e(X[ie]);_e(he.$$.fragment,N),_e(Ee.$$.fragment,N),pe=!0}},o(N){X=X.filter(Boolean);for(let ie=0;ie<X.length;ie+=1)we(X[ie]);we(he.$$.fragment,N),we(Ee.$$.fragment,N),pe=!1},d(N){N&&d(e),it(X,N),N&&d(Te),Pe(he,N),N&&d(de),Pe(Ee,N),Re=!1,ot(Se)}}}function Kr(a,e,n){let s,c,l,f;ze(a,tr,_=>n(0,s=_)),ze(a,Qe,_=>n(24,c=_)),ze(a,je,_=>n(5,l=_)),ze(a,tt,_=>n(6,f=_));let D=[],o=null,y=null,u=0;function I(_,$){vr.show({x:_.pageX,y:_.pageY},[{title:"Set category",icon:"fa-solid fa-tag",action:T},{title:"Remove",icon:"fa-solid fa-trash",style:"has-text-danger",action:H}])}function m(){y.show(S)}function T(){let _=[];for(var $ of l)_.push($[0]);o.show().then(k=>{We.updateAllCategory(_,k)})}function H(){Xt.show(`Are you sure you want to delete these transactions (${je.length}) ?`,"Delete transactions","is-danger").then(_=>{_&&We.remove(je)})}function j(_){n(4,u=_);let $=null;switch(_){case 0:$=Jt();break;case 1:$=new Date(new Date().setMonth(new Date().getMonth()-1));break;case 6:$=new Date(new Date().setMonth(new Date().getMonth()-6));break;case 12:$=new Date(new Date().setMonth(new Date().getMonth()-12));break;default:$=null}Mt(Qe,c.date=$,c)}function C(_){for(var $ of s)P($,_,!1);n(1,D),n(0,s)}function P(_,$,k=!0){_.selected=$,je.update(E=>($?E.set(_.id,_):E.delete(_.id),E)),k&&(n(1,D),n(0,s))}let{accountId:S=null}=e;const L=_=>C(_.target.checked),U=()=>Mt(tt,f=!f,f),oe=()=>j(0),ae=()=>j(1),V=()=>j(6),t=()=>j(12),r=()=>j(-1),h=_=>{P(_,!_.selected)},w=(_,$)=>{P(_,!0),I($)};function A(_){o=_,n(2,o)}function F(_){y=_,n(3,y)}return a.$$set=_=>{"accountId"in _&&n(12,S=_.accountId)},a.$$.update=()=>{a.$$.dirty[0]&1&&n(1,D=Gt.groupTransactionsByDate(s))},[s,D,o,y,u,l,f,I,m,j,C,P,S,L,U,oe,ae,V,t,r,h,w,A,F]}class Wr extends Je{constructor(e){super(),Ge(this,e,Kr,Hr,Xe,{accountId:12},null,[-1,-1])}}function Qr(a){var m;let e,n,s,c,l,f,D,o,y,u,I;return c=new Cr({props:{account:a[0],transactionsRecap:a[1]}}),D=new dr({props:{transactionsRecap:a[1]}}),u=new Wr({props:{accountId:(m=a[0])==null?void 0:m.id}}),{c(){e=W(),n=g("div"),s=g("div"),Ne(c.$$.fragment),l=W(),f=g("div"),Ne(D.$$.fragment),o=W(),y=g("div"),Ne(u.$$.fragment),this.h()},l(T){mr("svelte-1832t0f",document.head).forEach(d),e=Q(T),n=v(T,"DIV",{class:!0});var j=b(n);s=v(j,"DIV",{class:!0});var C=b(s);Fe(c.$$.fragment,C),C.forEach(d),l=Q(j),f=v(j,"DIV",{class:!0});var P=b(f);Fe(D.$$.fragment,P),P.forEach(d),j.forEach(d),o=Q(T),y=v(T,"DIV",{});var S=b(y);Fe(u.$$.fragment,S),S.forEach(d),this.h()},h(){document.title="MePloutos - Account",p(s,"class","column pb-2"),p(f,"class","column pb-2"),p(n,"class","columns is-variable is-1 mb-0")},m(T,H){me(T,e,H),me(T,n,H),i(n,s),Ve(c,s,null),i(n,l),i(n,f),Ve(D,f,null),me(T,o,H),me(T,y,H),Ve(u,y,null),I=!0},p(T,[H]){var S;const j={};H&1&&(j.account=T[0]),H&2&&(j.transactionsRecap=T[1]),c.$set(j);const C={};H&2&&(C.transactionsRecap=T[1]),D.$set(C);const P={};H&1&&(P.accountId=(S=T[0])==null?void 0:S.id),u.$set(P)},i(T){I||(_e(c.$$.fragment,T),_e(D.$$.fragment,T),_e(u.$$.fragment,T),I=!0)},o(T){we(c.$$.fragment,T),we(D.$$.fragment,T),we(u.$$.fragment,T),I=!1},d(T){T&&d(e),T&&d(n),Pe(c),Pe(D),T&&d(o),T&&d(y),Pe(u)}}}function Jr(a,e,n){let s,c;return ze(a,Er,l=>n(0,s=l)),ze(a,kr,l=>n(1,c=l)),[s,c]}class ca extends Je{constructor(e){super(),Ge(this,e,Jr,Qr,Xe,{})}}export{ca as component,la as universal};
