import{r as Bt,w as Ut,d as qt}from"../chunks/index.b5ec8d3d.js";import{g as $t,f as zt}from"../chunks/BaseRepo.b0f9c191.js";import{T as Be,A as Qe,b as jt,c as Ht,d as Kt,p as Wt}from"../chunks/store.ced03d2a.js";import{T as Mt,A as Qt,C as Jt}from"../chunks/index.08da1576.js";import{S as Ue,i as qe,s as ze,w as et,R as tt,k as g,a as G,y as Oe,l as v,m as b,h as d,c as X,z as Se,n as p,b as _e,A as $e,g as ve,v as Je,d as Ie,f as Ge,T as rt,B as Me,D as Ve,q as be,r as Ee,E as o,F as Ce,u as je,K as Xe,G as Ye,p as Ke,I as We,V as Gt,W as mt,C as _t,X as Xt,e as gt,H as Yt,U as Zt,N as xt}from"../chunks/index.ecd3f872.js";import{j as er}from"../chunks/singletons.8a93c538.js";import{C as tr}from"../chunks/CreateUpdateModal.431ead9f.js";import{a as Nt}from"../chunks/Confirm.eda23a4f.js";import{M as Ft}from"../chunks/Money.8cb7f686.js";import{a as rr}from"../chunks/ContextMenu.861c86bb.js";import{C as Vt}from"../chunks/CategoryIcon.3bb2426d.js";import{b as vt}from"../chunks/Alert.858543de.js";import{S as ar}from"../chunks/save.02a1bd69.js";function nr(a,r,n){return Bt(n==null?void 0:n.initialValue,h=>{let c=null;const l=y=>{c&&c.unsubscribe(),c=$t(()=>a(y)).subscribe({next:k=>{h(k)},error:n==null?void 0:n.onError})};r&&r.subscribe(y=>{l(y)})})}let nt=null;function sr(a){nt=a}const at=Ut({date:new Date(new Date().setMonth(new Date().getMonth()-1))}),ir=$t(()=>Qe.getById(nt)),Pt=nr(a=>Be.getByAccount(nt,a.date),at,{initialValue:[]}),or=qt(Pt,a=>Mt.getTransactionsRecap(a));async function lr({params:a}){sr(a.id)}const Jr=Object.freeze(Object.defineProperty({__proto__:null,load:lr},Symbol.toStringTag,{value:"Module"})),cr=er("goto");function bt(a,r,n){const s=a.slice();return s[7]=r[n],s}function Et(a){let r,n,s,h,c,l,y,i,k,u,w,m,F,C,z,I,B,$,N,U,le=a[0].name+"",ue,V,e,t,f,_,R,M;n=new Ft({props:{value:a[0].balance}});let L=a[1].categoriesNegative,P=[];for(let D=0;D<L.length;D+=1)P[D]=yt(bt(a,L,D));return f=new Qt({props:{transactionsTotals:a[1].totals}}),{c(){r=g("h2"),Oe(n.$$.fragment),s=G(),h=g("div"),c=g("div"),l=g("button"),y=g("span"),i=g("i"),k=G(),u=g("div"),w=g("div"),m=g("a"),F=g("i"),C=be(" Edit account"),z=G(),I=g("a"),B=g("i"),$=be(" Delete account"),N=G(),U=g("span"),ue=be(le),V=G(),e=g("div");for(let D=0;D<P.length;D+=1)P[D].c();t=G(),Oe(f.$$.fragment),this.h()},l(D){r=v(D,"H2",{class:!0});var E=b(r);Se(n.$$.fragment,E),s=X(E),h=v(E,"DIV",{class:!0});var j=b(h);c=v(j,"DIV",{class:!0});var O=b(c);l=v(O,"BUTTON",{class:!0,"aria-haspopup":!0});var H=b(l);y=v(H,"SPAN",{class:!0});var Y=b(y);i=v(Y,"I",{class:!0}),b(i).forEach(d),Y.forEach(d),H.forEach(d),O.forEach(d),k=X(j),u=v(j,"DIV",{class:!0,role:!0});var A=b(u);w=v(A,"DIV",{class:!0});var Q=b(w);m=v(Q,"A",{class:!0});var ae=b(m);F=v(ae,"I",{class:!0}),b(F).forEach(d),C=Ee(ae," Edit account"),ae.forEach(d),z=X(Q),I=v(Q,"A",{class:!0});var Z=b(I);B=v(Z,"I",{class:!0}),b(B).forEach(d),$=Ee(Z," Delete account"),Z.forEach(d),Q.forEach(d),A.forEach(d),j.forEach(d),E.forEach(d),N=X(D),U=v(D,"SPAN",{class:!0});var se=b(U);ue=Ee(se,le),se.forEach(d),V=X(D),e=v(D,"DIV",{class:!0});var ne=b(e);for(let ce=0;ce<P.length;ce+=1)P[ce].l(ne);ne.forEach(d),t=X(D),Se(f.$$.fragment,D),this.h()},h(){p(i,"class","fa-solid fa-ellipsis-vertical"),p(y,"class","icon is-small"),p(l,"class","button is-small is-light"),p(l,"aria-haspopup","true"),p(c,"class","dropdown-trigger"),p(F,"class","fa-solid fa-file-pen mr-1"),p(m,"class","dropdown-item"),p(B,"class","fa-solid fa-trash mr-1"),p(I,"class","dropdown-item has-text-danger"),p(w,"class","dropdown-content"),p(u,"class","dropdown-menu"),p(u,"role","menu"),p(h,"class","dropdown is-right"),p(r,"class","title flex-container"),p(U,"class","has-text-grey"),p(e,"class","progress")},m(D,E){_e(D,r,E),$e(n,r,null),o(r,s),o(r,h),o(h,c),o(c,l),o(l,y),o(y,i),o(h,k),o(h,u),o(u,w),o(w,m),o(m,F),o(m,C),o(w,z),o(w,I),o(I,B),o(I,$),_e(D,N,E),_e(D,U,E),o(U,ue),_e(D,V,E),_e(D,e,E);for(let j=0;j<P.length;j+=1)P[j]&&P[j].m(e,null);_e(D,t,E),$e(f,D,E),_=!0,R||(M=[Ce(m,"click",a[5]),Ce(I,"click",a[4])],R=!0)},p(D,E){const j={};if(E&1&&(j.value=D[0].balance),n.$set(j),(!_||E&1)&&le!==(le=D[0].name+"")&&je(ue,le),E&10){L=D[1].categoriesNegative;let H;for(H=0;H<L.length;H+=1){const Y=bt(D,L,H);P[H]?P[H].p(Y,E):(P[H]=yt(Y),P[H].c(),P[H].m(e,null))}for(;H<P.length;H+=1)P[H].d(1);P.length=L.length}const O={};E&2&&(O.transactionsTotals=D[1].totals),f.$set(O)},i(D){_||(ve(n.$$.fragment,D),ve(f.$$.fragment,D),_=!0)},o(D){Ie(n.$$.fragment,D),Ie(f.$$.fragment,D),_=!1},d(D){D&&d(r),Me(n),D&&d(N),D&&d(U),D&&d(V),D&&d(e),Xe(P,D),D&&d(t),Me(f,D),R=!1,Ye(M)}}}function yt(a){let r;return{c(){r=g("div"),this.h()},l(n){r=v(n,"DIV",{class:!0,style:!0}),b(r).forEach(d),this.h()},h(){var n;p(r,"class","progress-bar"),Ke(r,"background-color",(n=a[3].get(a[7].id))==null?void 0:n.color),Ke(r,"width",a[7].value*100/a[1].totals.negativeTotal+"%")},m(n,s){_e(n,r,s)},p(n,s){var h;s&10&&Ke(r,"background-color",(h=n[3].get(n[7].id))==null?void 0:h.color),s&2&&Ke(r,"width",n[7].value*100/n[1].totals.negativeTotal+"%")},d(n){n&&d(r)}}}function ur(a){let r,n,s,h,c,l=a[0]&&a[1]&&Et(a);function y(k){a[6](k)}let i={name:"Account",repo:Qe,form:[[{prop:"color",type:"color",class:"is-one-quarter"},{prop:"name"}]]};return a[2]!==void 0&&(i.modal=a[2]),s=new tr({props:i}),et.push(()=>tt(s,"modal",y)),{c(){r=g("div"),l&&l.c(),n=G(),Oe(s.$$.fragment),this.h()},l(k){r=v(k,"DIV",{class:!0});var u=b(r);l&&l.l(u),u.forEach(d),n=X(k),Se(s.$$.fragment,k),this.h()},h(){p(r,"class","box mb-0")},m(k,u){_e(k,r,u),l&&l.m(r,null),_e(k,n,u),$e(s,k,u),c=!0},p(k,[u]){k[0]&&k[1]?l?(l.p(k,u),u&3&&ve(l,1)):(l=Et(k),l.c(),ve(l,1),l.m(r,null)):l&&(Je(),Ie(l,1,1,()=>{l=null}),Ge());const w={};!h&&u&4&&(h=!0,w.modal=k[2],rt(()=>h=!1)),s.$set(w)},i(k){c||(ve(l),ve(s.$$.fragment,k),c=!0)},o(k){Ie(l),Ie(s.$$.fragment,k),c=!1},d(k){k&&d(r),l&&l.d(),k&&d(n),Me(s,k)}}}function dr(a,r,n){let s;Ve(a,jt,u=>n(3,s=u));function h(){Nt.show(`Are you sure you want to delete the account '${l.name}' and all linked transactions ?`,"Delete account","is-danger").then(u=>{u&&(Qe.remove(l.id),cr("/"))})}let c=null,{account:l=null}=r,{transactionsRecap:y=null}=r;const i=()=>c.show(l);function k(u){c=u,n(2,c)}return a.$$set=u=>{"account"in u&&n(0,l=u.account),"transactionsRecap"in u&&n(1,y=u.transactionsRecap)},[l,y,c,s,h,i,k]}class fr extends Ue{constructor(r){super(),qe(this,r,dr,ur,ze,{account:0,transactionsRecap:1})}}function kt(a,r,n){const s=a.slice();return s[7]=r[n],s}function wt(a){let r,n,s,h,c=a[7].name+"",l,y,i,k,u;s=new Vt({props:{categoryId:a[7].id}});function w(){return a[4](a[7])}return{c(){r=g("a"),n=g("span"),Oe(s.$$.fragment),h=G(),l=be(c),y=G(),this.h()},l(m){r=v(m,"A",{class:!0});var F=b(r);n=v(F,"SPAN",{class:!0});var C=b(n);Se(s.$$.fragment,C),C.forEach(d),h=X(F),l=Ee(F,c),y=X(F),F.forEach(d),this.h()},h(){p(n,"class","panel-icon"),p(r,"class","panel-block")},m(m,F){_e(m,r,F),o(r,n),$e(s,n,null),o(r,h),o(r,l),o(r,y),i=!0,k||(u=Ce(r,"click",w),k=!0)},p(m,F){a=m;const C={};F&2&&(C.categoryId=a[7].id),s.$set(C),(!i||F&2)&&c!==(c=a[7].name+"")&&je(l,c)},i(m){i||(ve(s.$$.fragment,m),i=!0)},o(m){Ie(s.$$.fragment,m),i=!1},d(m){m&&d(r),Me(s),k=!1,u()}}}function hr(a){let r,n,s,h,c,l,y,i,k,u,w,m,F,C,z=a[1],I=[];for(let $=0;$<z.length;$+=1)I[$]=wt(kt(a,z,$));const B=$=>Ie(I[$],1,1,()=>{I[$]=null});return{c(){r=g("div"),n=g("div"),s=G(),h=g("div"),c=g("div"),l=g("div"),y=g("span"),i=be("Select a category"),k=G();for(let $=0;$<I.length;$+=1)I[$].c();u=G(),w=g("button"),this.h()},l($){r=v($,"DIV",{class:!0});var N=b(r);n=v(N,"DIV",{class:!0}),b(n).forEach(d),s=X(N),h=v(N,"DIV",{class:!0});var U=b(h);c=v(U,"DIV",{class:!0});var le=b(c);l=v(le,"DIV",{class:!0});var ue=b(l);y=v(ue,"SPAN",{class:!0});var V=b(y);i=Ee(V,"Select a category"),V.forEach(d),ue.forEach(d),k=X(le);for(let e=0;e<I.length;e+=1)I[e].l(le);le.forEach(d),U.forEach(d),u=X(N),w=v(N,"BUTTON",{class:!0,"aria-label":!0}),b(w).forEach(d),N.forEach(d),this.h()},h(){p(n,"class","modal-background"),p(y,"class","has-text-grey-lighter"),p(l,"class","panel-block"),p(c,"class","panel has-background-white"),p(h,"class","modal-content"),p(w,"class","modal-close is-large"),p(w,"aria-label","close"),p(r,"class","modal"),We(r,"is-active",a[0])},m($,N){_e($,r,N),o(r,n),o(r,s),o(r,h),o(h,c),o(c,l),o(l,y),o(y,i),o(c,k);for(let U=0;U<I.length;U+=1)I[U]&&I[U].m(c,null);o(r,u),o(r,w),m=!0,F||(C=Ce(r,"closing",a[5]),F=!0)},p($,[N]){if(N&6){z=$[1];let U;for(U=0;U<z.length;U+=1){const le=kt($,z,U);I[U]?(I[U].p(le,N),ve(I[U],1)):(I[U]=wt(le),I[U].c(),ve(I[U],1),I[U].m(c,null))}for(Je(),U=z.length;U<I.length;U+=1)B(U);Ge()}(!m||N&1)&&We(r,"is-active",$[0])},i($){if(!m){for(let N=0;N<z.length;N+=1)ve(I[N]);m=!0}},o($){I=I.filter(Boolean);for(let N=0;N<I.length;N+=1)Ie(I[N]);m=!1},d($){$&&d(r),Xe(I,$),F=!1,C()}}}function pr(a,r,n){let s;Ve(a,Ht,u=>n(1,s=u));function h(u){l(u),n(0,c=!1)}let c=!1,l=null;return[c,s,h,{show(){return n(0,c=!0),new Promise(function(u,w){l=u})}},u=>{h(u)},()=>{n(0,c=!1)}]}class mr extends Ue{constructor(r){super(),qe(this,r,pr,hr,ze,{modal:3})}get modal(){return this.$$.ctx[3]}}var _r=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function gr(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var Lt={exports:{}};/* @license
Papa Parse
v5.4.1
https://github.com/mholt/PapaParse
License: MIT
*/(function(a,r){(function(n,s){a.exports=s()})(_r,function n(){var s=typeof self<"u"?self:typeof window<"u"?window:s!==void 0?s:{},h=!s.document&&!!s.postMessage,c=s.IS_PAPA_WORKER||!1,l={},y=0,i={parse:function(e,t){var f=(t=t||{}).dynamicTyping||!1;if(V(f)&&(t.dynamicTypingFunction=f,f={}),t.dynamicTyping=f,t.transform=!!V(t.transform)&&t.transform,t.worker&&i.WORKERS_SUPPORTED){var _=function(){if(!i.WORKERS_SUPPORTED)return!1;var M=(P=s.URL||s.webkitURL||null,D=n.toString(),i.BLOB_URL||(i.BLOB_URL=P.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",D,")();"],{type:"text/javascript"})))),L=new s.Worker(M),P,D;return L.onmessage=$,L.id=y++,l[L.id]=L}();return _.userStep=t.step,_.userChunk=t.chunk,_.userComplete=t.complete,_.userError=t.error,t.step=V(t.step),t.chunk=V(t.chunk),t.complete=V(t.complete),t.error=V(t.error),delete t.worker,void _.postMessage({input:e,config:t,workerId:_.id})}var R=null;return i.NODE_STREAM_INPUT,typeof e=="string"?(e=function(M){return M.charCodeAt(0)===65279?M.slice(1):M}(e),R=t.download?new w(t):new F(t)):e.readable===!0&&V(e.read)&&V(e.on)?R=new C(t):(s.File&&e instanceof File||e instanceof Object)&&(R=new m(t)),R.stream(e)},unparse:function(e,t){var f=!1,_=!0,R=",",M=`\r
`,L='"',P=L+L,D=!1,E=null,j=!1;(function(){if(typeof t=="object"){if(typeof t.delimiter!="string"||i.BAD_DELIMITERS.filter(function(A){return t.delimiter.indexOf(A)!==-1}).length||(R=t.delimiter),(typeof t.quotes=="boolean"||typeof t.quotes=="function"||Array.isArray(t.quotes))&&(f=t.quotes),typeof t.skipEmptyLines!="boolean"&&typeof t.skipEmptyLines!="string"||(D=t.skipEmptyLines),typeof t.newline=="string"&&(M=t.newline),typeof t.quoteChar=="string"&&(L=t.quoteChar),typeof t.header=="boolean"&&(_=t.header),Array.isArray(t.columns)){if(t.columns.length===0)throw new Error("Option columns is empty");E=t.columns}t.escapeChar!==void 0&&(P=t.escapeChar+L),(typeof t.escapeFormulae=="boolean"||t.escapeFormulae instanceof RegExp)&&(j=t.escapeFormulae instanceof RegExp?t.escapeFormulae:/^[=+\-@\t\r].*$/)}})();var O=new RegExp(I(L),"g");if(typeof e=="string"&&(e=JSON.parse(e)),Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return H(null,e,D);if(typeof e[0]=="object")return H(E||Object.keys(e[0]),e,D)}else if(typeof e=="object")return typeof e.data=="string"&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields||E),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:typeof e.data[0]=="object"?Object.keys(e.data[0]):[]),Array.isArray(e.data[0])||typeof e.data[0]=="object"||(e.data=[e.data])),H(e.fields||[],e.data||[],D);throw new Error("Unable to serialize unrecognized input");function H(A,Q,ae){var Z="";typeof A=="string"&&(A=JSON.parse(A)),typeof Q=="string"&&(Q=JSON.parse(Q));var se=Array.isArray(A)&&0<A.length,ne=!Array.isArray(Q[0]);if(se&&_){for(var ce=0;ce<A.length;ce++)0<ce&&(Z+=R),Z+=Y(A[ce],ce);0<Q.length&&(Z+=M)}for(var T=0;T<Q.length;T++){var q=se?A.length:Q[T].length,K=!1,x=se?Object.keys(Q[T]).length===0:Q[T].length===0;if(ae&&!se&&(K=ae==="greedy"?Q[T].join("").trim()==="":Q[T].length===1&&Q[T][0].length===0),ae==="greedy"&&se){for(var re=[],pe=0;pe<q;pe++){var ee=ne?A[pe]:pe;re.push(Q[T][ee])}K=re.join("").trim()===""}if(!K){for(var ie=0;ie<q;ie++){0<ie&&!x&&(Z+=R);var fe=se&&ne?A[ie]:ie;Z+=Y(Q[T][fe],ie)}T<Q.length-1&&(!ae||0<q&&!x)&&(Z+=M)}}return Z}function Y(A,Q){if(A==null)return"";if(A.constructor===Date)return JSON.stringify(A).slice(1,25);var ae=!1;j&&typeof A=="string"&&j.test(A)&&(A="'"+A,ae=!0);var Z=A.toString().replace(O,P);return(ae=ae||f===!0||typeof f=="function"&&f(A,Q)||Array.isArray(f)&&f[Q]||function(se,ne){for(var ce=0;ce<ne.length;ce++)if(-1<se.indexOf(ne[ce]))return!0;return!1}(Z,i.BAD_DELIMITERS)||-1<Z.indexOf(R)||Z.charAt(0)===" "||Z.charAt(Z.length-1)===" ")?L+Z+L:Z}}};if(i.RECORD_SEP=String.fromCharCode(30),i.UNIT_SEP=String.fromCharCode(31),i.BYTE_ORDER_MARK="\uFEFF",i.BAD_DELIMITERS=["\r",`
`,'"',i.BYTE_ORDER_MARK],i.WORKERS_SUPPORTED=!h&&!!s.Worker,i.NODE_STREAM_INPUT=1,i.LocalChunkSize=10485760,i.RemoteChunkSize=5242880,i.DefaultDelimiter=",",i.Parser=B,i.ParserHandle=z,i.NetworkStreamer=w,i.FileStreamer=m,i.StringStreamer=F,i.ReadableStreamStreamer=C,s.jQuery){var k=s.jQuery;k.fn.parse=function(e){var t=e.config||{},f=[];return this.each(function(M){if(!(k(this).prop("tagName").toUpperCase()==="INPUT"&&k(this).attr("type").toLowerCase()==="file"&&s.FileReader)||!this.files||this.files.length===0)return!0;for(var L=0;L<this.files.length;L++)f.push({file:this.files[L],inputElem:this,instanceConfig:k.extend({},t)})}),_(),this;function _(){if(f.length!==0){var M,L,P,D,E=f[0];if(V(e.before)){var j=e.before(E.file,E.inputElem);if(typeof j=="object"){if(j.action==="abort")return M="AbortError",L=E.file,P=E.inputElem,D=j.reason,void(V(e.error)&&e.error({name:M},L,P,D));if(j.action==="skip")return void R();typeof j.config=="object"&&(E.instanceConfig=k.extend(E.instanceConfig,j.config))}else if(j==="skip")return void R()}var O=E.instanceConfig.complete;E.instanceConfig.complete=function(H){V(O)&&O(H,E.file,E.inputElem),R()},i.parse(E.file,E.instanceConfig)}else V(e.complete)&&e.complete()}function R(){f.splice(0,1),_()}}}function u(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(t){var f=le(t);f.chunkSize=parseInt(f.chunkSize),t.step||t.chunk||(f.chunkSize=null),this._handle=new z(f),(this._handle.streamer=this)._config=f}.call(this,e),this.parseChunk=function(t,f){if(this.isFirstChunk&&V(this._config.beforeFirstChunk)){var _=this._config.beforeFirstChunk(t);_!==void 0&&(t=_)}this.isFirstChunk=!1,this._halted=!1;var R=this._partialLine+t;this._partialLine="";var M=this._handle.parse(R,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var L=M.meta.cursor;this._finished||(this._partialLine=R.substring(L-this._baseIndex),this._baseIndex=L),M&&M.data&&(this._rowCount+=M.data.length);var P=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(c)s.postMessage({results:M,workerId:i.WORKER_ID,finished:P});else if(V(this._config.chunk)&&!f){if(this._config.chunk(M,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);M=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(M.data),this._completeResults.errors=this._completeResults.errors.concat(M.errors),this._completeResults.meta=M.meta),this._completed||!P||!V(this._config.complete)||M&&M.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),P||M&&M.meta.paused||this._nextChunk(),M}this._halted=!0},this._sendError=function(t){V(this._config.error)?this._config.error(t):c&&this._config.error&&s.postMessage({workerId:i.WORKER_ID,error:t,finished:!1})}}function w(e){var t;(e=e||{}).chunkSize||(e.chunkSize=i.RemoteChunkSize),u.call(this,e),this._nextChunk=h?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(f){this._input=f,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(t=new XMLHttpRequest,this._config.withCredentials&&(t.withCredentials=this._config.withCredentials),h||(t.onload=ue(this._chunkLoaded,this),t.onerror=ue(this._chunkError,this)),t.open(this._config.downloadRequestBody?"POST":"GET",this._input,!h),this._config.downloadRequestHeaders){var f=this._config.downloadRequestHeaders;for(var _ in f)t.setRequestHeader(_,f[_])}if(this._config.chunkSize){var R=this._start+this._config.chunkSize-1;t.setRequestHeader("Range","bytes="+this._start+"-"+R)}try{t.send(this._config.downloadRequestBody)}catch(M){this._chunkError(M.message)}h&&t.status===0&&this._chunkError()}},this._chunkLoaded=function(){t.readyState===4&&(t.status<200||400<=t.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:t.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(f){var _=f.getResponseHeader("Content-Range");return _===null?-1:parseInt(_.substring(_.lastIndexOf("/")+1))}(t),this.parseChunk(t.responseText)))},this._chunkError=function(f){var _=t.statusText||f;this._sendError(new Error(_))}}function m(e){var t,f;(e=e||{}).chunkSize||(e.chunkSize=i.LocalChunkSize),u.call(this,e);var _=typeof FileReader<"u";this.stream=function(R){this._input=R,f=R.slice||R.webkitSlice||R.mozSlice,_?((t=new FileReader).onload=ue(this._chunkLoaded,this),t.onerror=ue(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var R=this._input;if(this._config.chunkSize){var M=Math.min(this._start+this._config.chunkSize,this._input.size);R=f.call(R,this._start,M)}var L=t.readAsText(R,this._config.encoding);_||this._chunkLoaded({target:{result:L}})},this._chunkLoaded=function(R){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(R.target.result)},this._chunkError=function(){this._sendError(t.error)}}function F(e){var t;u.call(this,e=e||{}),this.stream=function(f){return t=f,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var f,_=this._config.chunkSize;return _?(f=t.substring(0,_),t=t.substring(_)):(f=t,t=""),this._finished=!t,this.parseChunk(f)}}}function C(e){u.call(this,e=e||{});var t=[],f=!0,_=!1;this.pause=function(){u.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){u.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(R){this._input=R,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){_&&t.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):f=!0},this._streamData=ue(function(R){try{t.push(typeof R=="string"?R:R.toString(this._config.encoding)),f&&(f=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(M){this._streamError(M)}},this),this._streamError=ue(function(R){this._streamCleanUp(),this._sendError(R)},this),this._streamEnd=ue(function(){this._streamCleanUp(),_=!0,this._streamData("")},this),this._streamCleanUp=ue(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function z(e){var t,f,_,R=Math.pow(2,53),M=-R,L=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,P=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,D=this,E=0,j=0,O=!1,H=!1,Y=[],A={data:[],errors:[],meta:{}};if(V(e.step)){var Q=e.step;e.step=function(T){if(A=T,se())Z();else{if(Z(),A.data.length===0)return;E+=T.data.length,e.preview&&E>e.preview?f.abort():(A.data=A.data[0],Q(A,D))}}}function ae(T){return e.skipEmptyLines==="greedy"?T.join("").trim()==="":T.length===1&&T[0].length===0}function Z(){return A&&_&&(ce("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+i.DefaultDelimiter+"'"),_=!1),e.skipEmptyLines&&(A.data=A.data.filter(function(T){return!ae(T)})),se()&&function(){if(!A)return;function T(K,x){V(e.transformHeader)&&(K=e.transformHeader(K,x)),Y.push(K)}if(Array.isArray(A.data[0])){for(var q=0;se()&&q<A.data.length;q++)A.data[q].forEach(T);A.data.splice(0,1)}else A.data.forEach(T)}(),function(){if(!A||!e.header&&!e.dynamicTyping&&!e.transform)return A;function T(K,x){var re,pe=e.header?{}:[];for(re=0;re<K.length;re++){var ee=re,ie=K[re];e.header&&(ee=re>=Y.length?"__parsed_extra":Y[re]),e.transform&&(ie=e.transform(ie,ee)),ie=ne(ee,ie),ee==="__parsed_extra"?(pe[ee]=pe[ee]||[],pe[ee].push(ie)):pe[ee]=ie}return e.header&&(re>Y.length?ce("FieldMismatch","TooManyFields","Too many fields: expected "+Y.length+" fields but parsed "+re,j+x):re<Y.length&&ce("FieldMismatch","TooFewFields","Too few fields: expected "+Y.length+" fields but parsed "+re,j+x)),pe}var q=1;return!A.data.length||Array.isArray(A.data[0])?(A.data=A.data.map(T),q=A.data.length):A.data=T(A.data,0),e.header&&A.meta&&(A.meta.fields=Y),j+=q,A}()}function se(){return e.header&&Y.length===0}function ne(T,q){return K=T,e.dynamicTypingFunction&&e.dynamicTyping[K]===void 0&&(e.dynamicTyping[K]=e.dynamicTypingFunction(K)),(e.dynamicTyping[K]||e.dynamicTyping)===!0?q==="true"||q==="TRUE"||q!=="false"&&q!=="FALSE"&&(function(x){if(L.test(x)){var re=parseFloat(x);if(M<re&&re<R)return!0}return!1}(q)?parseFloat(q):P.test(q)?new Date(q):q===""?null:q):q;var K}function ce(T,q,K,x){var re={type:T,code:q,message:K};x!==void 0&&(re.row=x),A.errors.push(re)}this.parse=function(T,q,K){var x=e.quoteChar||'"';if(e.newline||(e.newline=function(ee,ie){ee=ee.substring(0,1048576);var fe=new RegExp(I(ie)+"([^]*?)"+I(ie),"gm"),ke=(ee=ee.replace(fe,"")).split("\r"),De=ee.split(`
`),ye=1<De.length&&De[0].length<ke[0].length;if(ke.length===1||ye)return`
`;for(var W=0,de=0;de<ke.length;de++)ke[de][0]===`
`&&W++;return W>=ke.length/2?`\r
`:"\r"}(T,x)),_=!1,e.delimiter)V(e.delimiter)&&(e.delimiter=e.delimiter(T),A.meta.delimiter=e.delimiter);else{var re=function(ee,ie,fe,ke,De){var ye,W,de,he;De=De||[",","	","|",";",i.RECORD_SEP,i.UNIT_SEP];for(var Re=0;Re<De.length;Re++){var te=De[Re],Te=0,S=0,J=0;de=void 0;for(var me=new B({comments:ke,delimiter:te,newline:ie,preview:10}).parse(ee),we=0;we<me.data.length;we++)if(fe&&ae(me.data[we]))J++;else{var oe=me.data[we].length;S+=oe,de!==void 0?0<oe&&(Te+=Math.abs(oe-de),de=oe):de=oe}0<me.data.length&&(S/=me.data.length-J),(W===void 0||Te<=W)&&(he===void 0||he<S)&&1.99<S&&(W=Te,ye=te,he=S)}return{successful:!!(e.delimiter=ye),bestDelimiter:ye}}(T,e.newline,e.skipEmptyLines,e.comments,e.delimitersToGuess);re.successful?e.delimiter=re.bestDelimiter:(_=!0,e.delimiter=i.DefaultDelimiter),A.meta.delimiter=e.delimiter}var pe=le(e);return e.preview&&e.header&&pe.preview++,t=T,f=new B(pe),A=f.parse(t,q,K),Z(),O?{meta:{paused:!0}}:A||{meta:{paused:!1}}},this.paused=function(){return O},this.pause=function(){O=!0,f.abort(),t=V(e.chunk)?"":t.substring(f.getCharIndex())},this.resume=function(){D.streamer._halted?(O=!1,D.streamer.parseChunk(t,!0)):setTimeout(D.resume,3)},this.aborted=function(){return H},this.abort=function(){H=!0,f.abort(),A.meta.aborted=!0,V(e.complete)&&e.complete(A),t=""}}function I(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function B(e){var t,f=(e=e||{}).delimiter,_=e.newline,R=e.comments,M=e.step,L=e.preview,P=e.fastMode,D=t=e.quoteChar===void 0||e.quoteChar===null?'"':e.quoteChar;if(e.escapeChar!==void 0&&(D=e.escapeChar),(typeof f!="string"||-1<i.BAD_DELIMITERS.indexOf(f))&&(f=","),R===f)throw new Error("Comment character same as delimiter");R===!0?R="#":(typeof R!="string"||-1<i.BAD_DELIMITERS.indexOf(R))&&(R=!1),_!==`
`&&_!=="\r"&&_!==`\r
`&&(_=`
`);var E=0,j=!1;this.parse=function(O,H,Y){if(typeof O!="string")throw new Error("Input must be a string");var A=O.length,Q=f.length,ae=_.length,Z=R.length,se=V(M),ne=[],ce=[],T=[],q=E=0;if(!O)return ge();if(e.header&&!H){var K=O.split(_)[0].split(f),x=[],re={},pe=!1;for(var ee in K){var ie=K[ee];V(e.transformHeader)&&(ie=e.transformHeader(ie,ee));var fe=ie,ke=re[ie]||0;for(0<ke&&(pe=!0,fe=ie+"_"+ke),re[ie]=ke+1;x.includes(fe);)fe=fe+"_"+ke;x.push(fe)}if(pe){var De=O.split(_);De[0]=x.join(f),O=De.join(_)}}if(P||P!==!1&&O.indexOf(t)===-1){for(var ye=O.split(_),W=0;W<ye.length;W++){if(T=ye[W],E+=T.length,W!==ye.length-1)E+=_.length;else if(Y)return ge();if(!R||T.substring(0,Z)!==R){if(se){if(ne=[],J(T.split(f)),Fe(),j)return ge()}else J(T.split(f));if(L&&L<=W)return ne=ne.slice(0,L),ge(!0)}}return ge()}for(var de=O.indexOf(f,E),he=O.indexOf(_,E),Re=new RegExp(I(D)+I(t),"g"),te=O.indexOf(t,E);;)if(O[E]!==t)if(R&&T.length===0&&O.substring(E,E+Z)===R){if(he===-1)return ge();E=he+ae,he=O.indexOf(_,E),de=O.indexOf(f,E)}else if(de!==-1&&(de<he||he===-1))T.push(O.substring(E,de)),E=de+Q,de=O.indexOf(f,E);else{if(he===-1)break;if(T.push(O.substring(E,he)),oe(he+ae),se&&(Fe(),j))return ge();if(L&&ne.length>=L)return ge(!0)}else for(te=E,E++;;){if((te=O.indexOf(t,te+1))===-1)return Y||ce.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:ne.length,index:E}),we();if(te===A-1)return we(O.substring(E,te).replace(Re,t));if(t!==D||O[te+1]!==D){if(t===D||te===0||O[te-1]!==D){de!==-1&&de<te+1&&(de=O.indexOf(f,te+1)),he!==-1&&he<te+1&&(he=O.indexOf(_,te+1));var Te=me(he===-1?de:Math.min(de,he));if(O.substr(te+1+Te,Q)===f){T.push(O.substring(E,te).replace(Re,t)),O[E=te+1+Te+Q]!==t&&(te=O.indexOf(t,E)),de=O.indexOf(f,E),he=O.indexOf(_,E);break}var S=me(he);if(O.substring(te+1+S,te+1+S+ae)===_){if(T.push(O.substring(E,te).replace(Re,t)),oe(te+1+S+ae),de=O.indexOf(f,E),te=O.indexOf(t,E),se&&(Fe(),j))return ge();if(L&&ne.length>=L)return ge(!0);break}ce.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:ne.length,index:E}),te++}}else te++}return we();function J(Ae){ne.push(Ae),q=E}function me(Ae){var Le=0;if(Ae!==-1){var Pe=O.substring(te+1,Ae);Pe&&Pe.trim()===""&&(Le=Pe.length)}return Le}function we(Ae){return Y||(Ae===void 0&&(Ae=O.substring(E)),T.push(Ae),E=A,J(T),se&&Fe()),ge()}function oe(Ae){E=Ae,J(T),T=[],he=O.indexOf(_,E)}function ge(Ae){return{data:ne,errors:ce,meta:{delimiter:f,linebreak:_,aborted:j,truncated:!!Ae,cursor:q+(H||0)}}}function Fe(){M(ge()),ne=[],ce=[]}},this.abort=function(){j=!0},this.getCharIndex=function(){return E}}function $(e){var t=e.data,f=l[t.workerId],_=!1;if(t.error)f.userError(t.error,t.file);else if(t.results&&t.results.data){var R={abort:function(){_=!0,N(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:U,resume:U};if(V(f.userStep)){for(var M=0;M<t.results.data.length&&(f.userStep({data:t.results.data[M],errors:t.results.errors,meta:t.results.meta},R),!_);M++);delete t.results}else V(f.userChunk)&&(f.userChunk(t.results,R,t.file),delete t.results)}t.finished&&!_&&N(t.workerId,t.results)}function N(e,t){var f=l[e];V(f.userComplete)&&f.userComplete(t),f.terminate(),delete l[e]}function U(){throw new Error("Not implemented.")}function le(e){if(typeof e!="object"||e===null)return e;var t=Array.isArray(e)?[]:{};for(var f in e)t[f]=le(e[f]);return t}function ue(e,t){return function(){e.apply(t,arguments)}}function V(e){return typeof e=="function"}return c&&(s.onmessage=function(e){var t=e.data;if(i.WORKER_ID===void 0&&t&&(i.WORKER_ID=t.workerId),typeof t.input=="string")s.postMessage({workerId:i.WORKER_ID,results:i.parse(t.input,t.config),finished:!0});else if(s.File&&t.input instanceof File||t.input instanceof Object){var f=i.parse(t.input,t.config);f&&s.postMessage({workerId:i.WORKER_ID,results:f,finished:!0})}}),(w.prototype=Object.create(u.prototype)).constructor=w,(m.prototype=Object.create(u.prototype)).constructor=m,(F.prototype=Object.create(F.prototype)).constructor=F,(C.prototype=Object.create(u.prototype)).constructor=C,i})})(Lt);var vr=Lt.exports;const br=gr(vr),Er={labanquepostale:{csv:{date:[3,1],dayTimespan:30,balance:[4,1],transactions:{startLine:7,dateCol:0,descriptionCol:1,valueCol:2}}}};function yr(a){return new Promise((r,n)=>{br.parse(a,{delimiter:";",skipEmptyLines:!0,complete:function(s){r(s.data)},error:n})})}function It(a){return parseFloat(a.replace(",","."))}function Dt(a){let r=a.split("/");return new Date(Date.UTC(parseInt(r[2],10),parseInt(r[1],10)-1,parseInt(r[0],10)))}function kr(a,r,n){let s=[],h=It(a[r.balance[0]][r.balance[1]].replace()),c=Dt(a[r.date[0]][r.date[1]]),l=new Date(c);l.setDate(l.getDate()-r.dayTimespan);for(let y=r.transactions.startLine;y<a.length;y++)s.push(new Kt(Dt(a[y][r.transactions.dateCol]),a[y][r.transactions.descriptionCol].trim(),It(a[y][r.transactions.valueCol])));return{balance:h,dateMin:l,dateMax:c,transactions:s}}async function wr(a,r){switch(r.bank){case"labanquepostale":return kr(await yr(a),Er[r.bank].csv,r.accountId)}}function Ir(a,r,n){const s={};for(let h=n.length-1;h>=0;h--){let c=n[h];const l=c.date.toDateString();s[l]=s[l]+1||0,c.orderNumber=s[l],c.accountId=a}if(n.sort((h,c)=>c.date-h.date||c.orderNumber-h.orderNumber),!r)return n;if(n[0].date<=(r==null?void 0:r.date))return[];if(r){r.orderNumber+=1;let h=null;for(let c=n.length-1;c>=0;c--){if(n[c].date.getTime()==r.date.getTime()&&n[c].description==r.description&&n[c].value==r.value){n=n.slice(0,c);break}if(n[c].date.getTime()==r.date.getTime()&&(h||(h=c+1),n[c].orderNumber+=r.orderNumber),n[c].date>r.date){n=n.slice(0,h||c);break}}}return n}async function Dr(a,r){let{balance:n,dateMin:s,dateMax:h,transactions:c}=await wr(a,r);const l=await Be.getMostRecent(),y=Ir(r.accountId,l,c);return y.length?(Be.createAll(y),Qe.updateBalance(r.accountId,n),r.saveImportedFiles&&ar.saveImportedTransactions(y),{count:y.length}):{count:0}}const Cr={importTransactions:Dr};function Ct(a){let r=a[1][0].name+"",n;return{c(){n=be(r)},l(s){n=Ee(s,r)},m(s,h){_e(s,n,h)},p(s,h){h&2&&r!==(r=s[1][0].name+"")&&je(n,r)},d(s){s&&d(n)}}}function Ar(a){let r,n,s,h,c,l,y,i,k,u,w,m,F,C,z,I,B,$,N,U,le,ue,V,e,t,f,_,R,M,L,P,D,E,j,O,H,Y,A,Q,ae,Z,se,ne,ce,T=a[1]&&a[1][0]&&Ct(a);return{c(){r=g("div"),n=g("div"),s=G(),h=g("div"),c=g("header"),l=g("p"),y=be("Import"),i=G(),k=g("button"),u=G(),w=g("section"),m=g("div"),F=g("label"),C=be(`Bank\r
                    `),z=g("div"),I=g("div"),B=g("select"),$=g("option"),N=be("La banque postal : CSV"),U=G(),le=g("div"),ue=g("div"),V=g("div"),e=g("label"),t=g("input"),f=G(),_=g("span"),R=g("span"),M=g("i"),L=G(),P=g("span"),D=be("Choose a file…"),E=G(),j=g("span"),T&&T.c(),O=G(),H=g("footer"),Y=g("button"),A=be("Cancel"),Q=G(),ae=g("button"),Z=be("Import"),this.h()},l(q){r=v(q,"DIV",{class:!0});var K=b(r);n=v(K,"DIV",{class:!0}),b(n).forEach(d),s=X(K),h=v(K,"DIV",{class:!0});var x=b(h);c=v(x,"HEADER",{class:!0});var re=b(c);l=v(re,"P",{class:!0});var pe=b(l);y=Ee(pe,"Import"),pe.forEach(d),i=X(re),k=v(re,"BUTTON",{class:!0,"aria-label":!0}),b(k).forEach(d),re.forEach(d),u=X(x),w=v(x,"SECTION",{class:!0});var ee=b(w);m=v(ee,"DIV",{class:!0});var ie=b(m);F=v(ie,"LABEL",{class:!0});var fe=b(F);C=Ee(fe,`Bank\r
                    `),z=v(fe,"DIV",{class:!0});var ke=b(z);I=v(ke,"DIV",{class:!0});var De=b(I);B=v(De,"SELECT",{});var ye=b(B);$=v(ye,"OPTION",{});var W=b($);N=Ee(W,"La banque postal : CSV"),W.forEach(d),ye.forEach(d),De.forEach(d),ke.forEach(d),fe.forEach(d),ie.forEach(d),U=X(ee),le=v(ee,"DIV",{class:!0});var de=b(le);ue=v(de,"DIV",{class:!0});var he=b(ue);V=v(he,"DIV",{class:!0});var Re=b(V);e=v(Re,"LABEL",{class:!0});var te=b(e);t=v(te,"INPUT",{class:!0,type:!0,name:!0}),f=X(te),_=v(te,"SPAN",{class:!0});var Te=b(_);R=v(Te,"SPAN",{class:!0});var S=b(R);M=v(S,"I",{class:!0}),b(M).forEach(d),S.forEach(d),L=X(Te),P=v(Te,"SPAN",{class:!0});var J=b(P);D=Ee(J,"Choose a file…"),J.forEach(d),Te.forEach(d),E=X(te),j=v(te,"SPAN",{class:!0});var me=b(j);T&&T.l(me),me.forEach(d),te.forEach(d),Re.forEach(d),he.forEach(d),de.forEach(d),ee.forEach(d),O=X(x),H=v(x,"FOOTER",{class:!0});var we=b(H);Y=v(we,"BUTTON",{class:!0,"data-dismiss":!0});var oe=b(Y);A=Ee(oe,"Cancel"),oe.forEach(d),Q=X(we),ae=v(we,"BUTTON",{class:!0});var ge=b(ae);Z=Ee(ge,"Import"),ge.forEach(d),we.forEach(d),x.forEach(d),K.forEach(d),this.h()},h(){p(n,"class","modal-background"),p(l,"class","modal-card-title"),p(k,"class","delete"),p(k,"aria-label","close"),p(c,"class","modal-card-head"),$.__value="labanquepostale",$.value=$.__value,a[2]===void 0&&Gt(()=>a[6].call(B)),p(I,"class","select is-fullwidth"),p(z,"class","control"),p(F,"class","label"),p(m,"class","field"),p(t,"class","file-input"),p(t,"type","file"),p(t,"name","resume"),p(M,"class","gg-software-upload"),p(R,"class","file-icon"),p(P,"class","file-label"),p(_,"class","file-cta"),p(j,"class","file-name"),p(e,"class","file-label"),p(V,"class","file has-name is-boxed is-justify-content-center"),p(ue,"class","control"),p(le,"class","field"),p(w,"class","modal-card-body"),p(Y,"class","button"),p(Y,"data-dismiss","modal"),p(ae,"class","button is-success"),ae.disabled=se=!At(a[1]),p(H,"class","modal-card-foot is-justify-content-flex-end"),p(h,"class","modal-card"),p(r,"class","modal"),We(r,"is-active",!!a[0])},m(q,K){_e(q,r,K),o(r,n),o(r,s),o(r,h),o(h,c),o(c,l),o(l,y),o(c,i),o(c,k),o(h,u),o(h,w),o(w,m),o(m,F),o(F,C),o(F,z),o(z,I),o(I,B),o(B,$),o($,N),mt(B,a[2],!0),o(w,U),o(w,le),o(le,ue),o(ue,V),o(V,e),o(e,t),o(e,f),o(e,_),o(_,R),o(R,M),o(_,L),o(_,P),o(P,D),o(e,E),o(e,j),T&&T.m(j,null),o(h,O),o(h,H),o(H,Y),o(Y,A),o(H,Q),o(H,ae),o(ae,Z),ne||(ce=[Ce(B,"change",a[6]),Ce(t,"change",a[7]),Ce(ae,"click",a[3]),Ce(r,"closing",a[4])],ne=!0)},p(q,[K]){K&4&&mt(B,q[2]),q[1]&&q[1][0]?T?T.p(q,K):(T=Ct(q),T.c(),T.m(j,null)):T&&(T.d(1),T=null),K&2&&se!==(se=!At(q[1]))&&(ae.disabled=se),K&1&&We(r,"is-active",!!q[0])},i:_t,o:_t,d(q){q&&d(r),T&&T.d(),ne=!1,Ye(ce)}}}function At(a){return a&&a.length===1}function Tr(a,r,n){let s;Ve(a,Wt,m=>n(8,s=m));async function h(){let m=await Cr.importTransactions(l[0],{accountId:i,bank:y,saveImportedFiles:s.saveImportedFiles});m.count?vt.success(`${m.count} new transactions imported.`):vt.info("No new transaction imported."),c()}function c(){n(0,i=null)}let l,y="labanquepostale",{accountId:i=null}=r;const k={show(m=null){n(0,i=m)}};function u(){y=Xt(this),n(2,y)}function w(){l=this.files,n(1,l)}return a.$$set=m=>{"accountId"in m&&n(0,i=m.accountId)},[i,l,y,h,c,k,u,w]}class Rr extends Ue{constructor(r){super(),qe(this,r,Tr,Ar,ze,{accountId:0,modal:5})}get modal(){return this.$$.ctx[5]}}function Tt(a,r,n){const s=a.slice();return s[21]=r[n],s}function Rt(a,r,n){const s=a.slice();return s[24]=r[n],s[25]=r,s[26]=n,s}function Ot(a){let r,n,s,h,c,l=a[24].description+"",y,i,k,u,w,m,F;s=new Vt({props:{categoryId:a[24].categoryId,selected:a[24].selected}}),k=new Ft({props:{value:a[24].value}});function C(){return a[14](a[24],a[25],a[26])}function z(...I){return a[15](a[24],a[25],a[26],...I)}return{c(){r=g("a"),n=g("span"),Oe(s.$$.fragment),h=G(),c=g("div"),y=be(l),i=G(),Oe(k.$$.fragment),u=G(),this.h()},l(I){r=v(I,"A",{class:!0});var B=b(r);n=v(B,"SPAN",{class:!0});var $=b(n);Se(s.$$.fragment,$),$.forEach(d),h=X(B),c=v(B,"DIV",{class:!0});var N=b(c);y=Ee(N,l),i=X(N),Se(k.$$.fragment,N),N.forEach(d),u=X(B),B.forEach(d),this.h()},h(){p(n,"class","panel-icon"),p(c,"class","flex-container"),p(r,"class","panel-block")},m(I,B){_e(I,r,B),o(r,n),$e(s,n,null),o(r,h),o(r,c),o(c,y),o(c,i),$e(k,c,null),o(r,u),w=!0,m||(F=[Ce(r,"click",C),Ce(r,"contextmenu",Zt(z))],m=!0)},p(I,B){a=I;const $={};B&1&&($.categoryId=a[24].categoryId),B&1&&($.selected=a[24].selected),s.$set($),(!w||B&1)&&l!==(l=a[24].description+"")&&je(y,l);const N={};B&1&&(N.value=a[24].value),k.$set(N)},i(I){w||(ve(s.$$.fragment,I),ve(k.$$.fragment,I),w=!0)},o(I){Ie(s.$$.fragment,I),Ie(k.$$.fragment,I),w=!1},d(I){I&&d(r),Me(s),Me(k),m=!1,Ye(F)}}}function St(a){let r,n=a[21].date.toLocaleDateString()+"",s,h,c,l,y=a[21].transactions,i=[];for(let u=0;u<y.length;u+=1)i[u]=Ot(Rt(a,y,u));const k=u=>Ie(i[u],1,1,()=>{i[u]=null});return{c(){r=g("div"),s=be(n),h=G();for(let u=0;u<i.length;u+=1)i[u].c();c=gt(),this.h()},l(u){r=v(u,"DIV",{class:!0});var w=b(r);s=Ee(w,n),w.forEach(d),h=X(u);for(let m=0;m<i.length;m+=1)i[m].l(u);c=gt(),this.h()},h(){p(r,"class","panel-block has-text-grey-light has-background-light")},m(u,w){_e(u,r,w),o(r,s),_e(u,h,w);for(let m=0;m<i.length;m+=1)i[m]&&i[m].m(u,w);_e(u,c,w),l=!0},p(u,w){if((!l||w&1)&&n!==(n=u[21].date.toLocaleDateString()+"")&&je(s,n),w&17){y=u[21].transactions;let m;for(m=0;m<y.length;m+=1){const F=Rt(u,y,m);i[m]?(i[m].p(F,w),ve(i[m],1)):(i[m]=Ot(F),i[m].c(),ve(i[m],1),i[m].m(c.parentNode,c))}for(Je(),m=y.length;m<i.length;m+=1)k(m);Ge()}},i(u){if(!l){for(let w=0;w<y.length;w+=1)ve(i[w]);l=!0}},o(u){i=i.filter(Boolean);for(let w=0;w<i.length;w+=1)Ie(i[w]);l=!1},d(u){u&&d(r),u&&d(h),Xe(i,u),u&&d(c)}}}function Or(a){let r,n,s,h,c,l,y,i,k,u,w,m,F,C,z,I,B,$,N,U,le,ue,V,e,t,f,_,R,M,L,P,D,E,j,O,H,Y,A,Q,ae,Z,se,ne,ce,T,q,K,x,re,pe,ee,ie,fe,ke,De,ye=a[0],W=[];for(let S=0;S<ye.length;S+=1)W[S]=St(Tt(a,ye,S));const de=S=>Ie(W[S],1,1,()=>{W[S]=null});function he(S){a[16](S)}let Re={};a[1]!==void 0&&(Re.modal=a[1]),x=new mr({props:Re}),et.push(()=>tt(x,"modal",he));function te(S){a[17](S)}let Te={};return a[2]!==void 0&&(Te.modal=a[2]),ee=new Rr({props:Te}),et.push(()=>tt(ee,"modal",te)),{c(){r=g("nav"),n=g("div"),s=g("span"),h=be("Transactions"),c=G(),l=g("div"),y=g("div"),i=g("div"),k=g("button"),u=g("span"),w=g("i"),m=G(),F=g("div"),C=g("div"),z=g("a"),I=be("Current month"),$=G(),N=g("a"),U=be("1 month"),ue=G(),V=g("a"),e=be("6 month"),f=G(),_=g("a"),R=be("1 year"),L=G(),P=g("a"),D=be("All"),j=G(),O=g("div"),H=g("div"),Y=g("button"),A=g("span"),Q=g("i"),ae=G(),Z=g("div"),se=g("div"),ne=g("a"),ce=g("i"),T=be(" Import transactions"),q=G();for(let S=0;S<W.length;S+=1)W[S].c();K=G(),Oe(x.$$.fragment),pe=G(),Oe(ee.$$.fragment),this.h()},l(S){r=v(S,"NAV",{class:!0});var J=b(r);n=v(J,"DIV",{class:!0});var me=b(n);s=v(me,"SPAN",{class:!0});var we=b(s);h=Ee(we,"Transactions"),we.forEach(d),c=X(me),l=v(me,"DIV",{});var oe=b(l);y=v(oe,"DIV",{class:!0});var ge=b(y);i=v(ge,"DIV",{class:!0});var Fe=b(i);k=v(Fe,"BUTTON",{class:!0,"aria-haspopup":!0});var Ae=b(k);u=v(Ae,"SPAN",{class:!0});var Le=b(u);w=v(Le,"I",{class:!0}),b(w).forEach(d),Le.forEach(d),Ae.forEach(d),Fe.forEach(d),m=X(ge),F=v(ge,"DIV",{class:!0,role:!0});var Pe=b(F);C=v(Pe,"DIV",{class:!0});var Ne=b(C);z=v(Ne,"A",{class:!0});var st=b(z);I=Ee(st,"Current month"),st.forEach(d),$=X(Ne),N=v(Ne,"A",{class:!0});var it=b(N);U=Ee(it,"1 month"),it.forEach(d),ue=X(Ne),V=v(Ne,"A",{class:!0});var ot=b(V);e=Ee(ot,"6 month"),ot.forEach(d),f=X(Ne),_=v(Ne,"A",{class:!0});var lt=b(_);R=Ee(lt,"1 year"),lt.forEach(d),L=X(Ne),P=v(Ne,"A",{class:!0});var ct=b(P);D=Ee(ct,"All"),ct.forEach(d),Ne.forEach(d),Pe.forEach(d),ge.forEach(d),j=X(oe),O=v(oe,"DIV",{class:!0});var He=b(O);H=v(He,"DIV",{class:!0});var ut=b(H);Y=v(ut,"BUTTON",{class:!0,"aria-haspopup":!0});var dt=b(Y);A=v(dt,"SPAN",{class:!0});var ft=b(A);Q=v(ft,"I",{class:!0}),b(Q).forEach(d),ft.forEach(d),dt.forEach(d),ut.forEach(d),ae=X(He),Z=v(He,"DIV",{class:!0,role:!0});var ht=b(Z);se=v(ht,"DIV",{class:!0});var pt=b(se);ne=v(pt,"A",{class:!0});var Ze=b(ne);ce=v(Ze,"I",{class:!0}),b(ce).forEach(d),T=Ee(Ze," Import transactions"),Ze.forEach(d),pt.forEach(d),ht.forEach(d),He.forEach(d),oe.forEach(d),me.forEach(d),q=X(J);for(let xe=0;xe<W.length;xe+=1)W[xe].l(J);J.forEach(d),K=X(S),Se(x.$$.fragment,S),pe=X(S),Se(ee.$$.fragment,S),this.h()},h(){p(s,"class","has-text-grey-lighter"),p(w,"class","fa-solid fa-filter"),p(u,"class","icon is-small"),p(k,"class","button is-small is-light"),p(k,"aria-haspopup","true"),p(i,"class","dropdown-trigger"),p(z,"class",B="dropdown-item "+(a[3]==0?"is-active":"")),p(N,"class",le="dropdown-item "+(a[3]==1?"is-active":"")),p(V,"class",t="dropdown-item "+(a[3]==6?"is-active":"")),p(_,"class",M="dropdown-item "+(a[3]==12?"is-active":"")),p(P,"class",E="dropdown-item "+(a[3]==-1?"is-active":"")),p(C,"class","dropdown-content"),p(F,"class","dropdown-menu"),p(F,"role","menu"),p(y,"class","dropdown is-right"),p(Q,"class","fa-solid fa-ellipsis-vertical"),p(A,"class","icon is-small"),p(Y,"class","button is-small is-light"),p(Y,"aria-haspopup","true"),p(H,"class","dropdown-trigger"),p(ce,"class","fa-solid fa-file-import"),p(ne,"class","dropdown-item"),p(se,"class","dropdown-content"),p(Z,"class","dropdown-menu"),p(Z,"role","menu"),p(O,"class","dropdown is-right"),p(n,"class","panel-block flex-container"),p(r,"class","panel")},m(S,J){_e(S,r,J),o(r,n),o(n,s),o(s,h),o(n,c),o(n,l),o(l,y),o(y,i),o(i,k),o(k,u),o(u,w),o(y,m),o(y,F),o(F,C),o(C,z),o(z,I),o(C,$),o(C,N),o(N,U),o(C,ue),o(C,V),o(V,e),o(C,f),o(C,_),o(_,R),o(C,L),o(C,P),o(P,D),o(l,j),o(l,O),o(O,H),o(H,Y),o(Y,A),o(A,Q),o(O,ae),o(O,Z),o(Z,se),o(se,ne),o(ne,ce),o(ne,T),o(r,q);for(let me=0;me<W.length;me+=1)W[me]&&W[me].m(r,null);_e(S,K,J),$e(x,S,J),_e(S,pe,J),$e(ee,S,J),fe=!0,ke||(De=[Ce(z,"click",a[9]),Ce(N,"click",a[10]),Ce(V,"click",a[11]),Ce(_,"click",a[12]),Ce(P,"click",a[13]),Ce(ne,"click",a[5])],ke=!0)},p(S,[J]){if((!fe||J&8&&B!==(B="dropdown-item "+(S[3]==0?"is-active":"")))&&p(z,"class",B),(!fe||J&8&&le!==(le="dropdown-item "+(S[3]==1?"is-active":"")))&&p(N,"class",le),(!fe||J&8&&t!==(t="dropdown-item "+(S[3]==6?"is-active":"")))&&p(V,"class",t),(!fe||J&8&&M!==(M="dropdown-item "+(S[3]==12?"is-active":"")))&&p(_,"class",M),(!fe||J&8&&E!==(E="dropdown-item "+(S[3]==-1?"is-active":"")))&&p(P,"class",E),J&17){ye=S[0];let oe;for(oe=0;oe<ye.length;oe+=1){const ge=Tt(S,ye,oe);W[oe]?(W[oe].p(ge,J),ve(W[oe],1)):(W[oe]=St(ge),W[oe].c(),ve(W[oe],1),W[oe].m(r,null))}for(Je(),oe=ye.length;oe<W.length;oe+=1)de(oe);Ge()}const me={};!re&&J&2&&(re=!0,me.modal=S[1],rt(()=>re=!1)),x.$set(me);const we={};!ie&&J&4&&(ie=!0,we.modal=S[2],rt(()=>ie=!1)),ee.$set(we)},i(S){if(!fe){for(let J=0;J<ye.length;J+=1)ve(W[J]);ve(x.$$.fragment,S),ve(ee.$$.fragment,S),fe=!0}},o(S){W=W.filter(Boolean);for(let J=0;J<W.length;J+=1)Ie(W[J]);Ie(x.$$.fragment,S),Ie(ee.$$.fragment,S),fe=!1},d(S){S&&d(r),Xe(W,S),S&&d(K),Me(x,S),S&&d(pe),Me(ee,S),ke=!1,Ye(De)}}}function Sr(a,r,n){let s;Ve(a,at,e=>n(18,s=e));let h=[],c=null,l=null,y=0;function i(e,t){rr.show({x:e.pageX,y:e.pageY},[{title:"Set category",icon:"fa-solid fa-tag",action:u},{title:"Remove",icon:"fa-solid fa-trash",style:"has-text-danger",action:w}])}function k(){l.show(F)}function u(){c.show().then(e=>{Be.update(C.filter(t=>t.selected),e)})}function w(){const e=C.filter(t=>t.selected);Nt.show(`Are you sure you want to delete these transactions (${e.length}) ?`,"Delete transactions","is-danger").then(t=>{t&&Be.remove(e)})}function m(e){n(3,y=e);let t=null;switch(e){case 0:t=zt();break;case 1:t=new Date(new Date().setMonth(new Date().getMonth()-1));break;case 6:t=new Date(new Date().setMonth(new Date().getMonth()-6));break;case 12:t=new Date(new Date().setMonth(new Date().getMonth()-12));break;default:t=null}Yt(at,s.date=t,s)}let{accountId:F=null}=r,{transactions:C=null}=r;const z=()=>m(0),I=()=>m(1),B=()=>m(6),$=()=>m(12),N=()=>m(-1),U=(e,t,f)=>{n(0,t[f].selected=!e.selected,h)},le=(e,t,f,_)=>{n(0,t[f].selected=!0,h),i(_)};function ue(e){c=e,n(1,c)}function V(e){l=e,n(2,l)}return a.$$set=e=>{"accountId"in e&&n(7,F=e.accountId),"transactions"in e&&n(8,C=e.transactions)},a.$$.update=()=>{a.$$.dirty&256&&n(0,h=Mt.groupTransactionsByDate(C))},[h,c,l,y,i,k,m,F,C,z,I,B,$,N,U,le,ue,V]}class $r extends Ue{constructor(r){super(),qe(this,r,Sr,Or,ze,{accountId:7,transactions:8})}}function Mr(a){var F;let r,n,s,h,c,l,y,i,k,u,w,m;return h=new fr({props:{account:a[0],transactionsRecap:a[1]}}),i=new Jt({props:{transactionsRecap:a[1]}}),w=new $r({props:{transactions:a[2],accountId:(F=a[0])==null?void 0:F.id}}),{c(){r=G(),n=g("div"),s=g("div"),Oe(h.$$.fragment),c=G(),l=g("div"),y=g("div"),Oe(i.$$.fragment),k=G(),u=g("div"),Oe(w.$$.fragment),this.h()},l(C){xt("svelte-1832t0f",document.head).forEach(d),r=X(C),n=v(C,"DIV",{class:!0});var I=b(n);s=v(I,"DIV",{class:!0});var B=b(s);Se(h.$$.fragment,B),B.forEach(d),c=X(I),l=v(I,"DIV",{class:!0});var $=b(l);y=v($,"DIV",{class:!0});var N=b(y);Se(i.$$.fragment,N),N.forEach(d),$.forEach(d),I.forEach(d),k=X(C),u=v(C,"DIV",{});var U=b(u);Se(w.$$.fragment,U),U.forEach(d),this.h()},h(){document.title="MePloutos - Account",p(s,"class","column pb-2"),p(y,"class","flex-list"),p(l,"class","column pb-2"),p(n,"class","columns is-variable is-1 mb-0")},m(C,z){_e(C,r,z),_e(C,n,z),o(n,s),$e(h,s,null),o(n,c),o(n,l),o(l,y),$e(i,y,null),_e(C,k,z),_e(C,u,z),$e(w,u,null),m=!0},p(C,[z]){var N;const I={};z&1&&(I.account=C[0]),z&2&&(I.transactionsRecap=C[1]),h.$set(I);const B={};z&2&&(B.transactionsRecap=C[1]),i.$set(B);const $={};z&4&&($.transactions=C[2]),z&1&&($.accountId=(N=C[0])==null?void 0:N.id),w.$set($)},i(C){m||(ve(h.$$.fragment,C),ve(i.$$.fragment,C),ve(w.$$.fragment,C),m=!0)},o(C){Ie(h.$$.fragment,C),Ie(i.$$.fragment,C),Ie(w.$$.fragment,C),m=!1},d(C){C&&d(r),C&&d(n),Me(h),Me(i),C&&d(k),C&&d(u),Me(w)}}}function Nr(a,r,n){let s,h,c;return Ve(a,ir,l=>n(0,s=l)),Ve(a,or,l=>n(1,h=l)),Ve(a,Pt,l=>n(2,c=l)),[s,h,c]}class Gr extends Ue{constructor(r){super(),qe(this,r,Nr,Mr,ze,{})}}export{Gr as component,Jr as universal};
